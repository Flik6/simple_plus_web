import{d as X,a1 as c,r as P,e as ue,a as t,an as R,ac as $,G as ge,P as me,g,O as fe,aj as K,a8 as he,s as ye,N as U,k as oe,m as we,cb as xe,o as S,c as Y,bR as be,j as ve,w as z,ai as Z,H as M,h as N,t as B,i as L,ay as Pe,F as Se,_ as _e,L as ke,D as Ae,aS as le,a4 as ie,az as ze,__tla as Le}from"./index-DPXDMqGw.js";import{g as D,_ as Oe,__tla as Te}from"./Form-BUBOUlkr.js";import{_ as Ce}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{u as je,__tla as Fe}from"./useForm-DgtVb6HB.js";import{d as Re}from"./download--D_IyRio.js";let re,se,ce,$e=Promise.all([(()=>{try{return Le}catch{}})(),(()=>{try{return Te}catch{}})(),(()=>{try{return Fe}catch{}})()]).then(async()=>{let ee,te,y;se=Ce(X({name:"Table",props:{pageSize:c.number.def(10),currentPage:c.number.def(1),selection:c.bool.def(!1),showOverflowTooltip:c.bool.def(!0),columns:{type:Array,default:()=>[]},expand:c.bool.def(!1),pagination:{type:Object,default:()=>{}},reserveSelection:c.bool.def(!1),loading:c.bool.def(!1),reserveIndex:c.bool.def(!1),align:c.string.validate(e=>["left","center","right"].includes(e)).def("center"),headerAlign:c.string.validate(e=>["left","center","right"].includes(e)).def("center"),data:{type:Array,default:()=>[]}},emits:["update:pageSize","update:currentPage","register"],setup(e,{attrs:o,slots:d,emit:f,expose:h}){const w=P();ue(()=>{const a=t(w);f("register",a==null?void 0:a.$parent,w)});const b=P(e.pageSize),u=P(e.currentPage),n=P({}),l=P({}),i=R(()=>{const a={...e};return Object.assign(a,t(l)),a}),_=(a,O)=>{var k;const{columns:T}=t(i);for(const C of O||T)for(const j of a)C.field===j.field?ye(C,j.path,j.value):(k=C.children)!=null&&k.length&&_(a,C.children)},I=P([]),r=a=>{I.value=a};h({setProps:(a={})=>{l.value=Object.assign(t(l),a),n.value=a},setColumn:_,selections:I});const v=R(()=>Object.assign({small:!1,background:!0,pagerCount:document.body.clientWidth<992?5:7,layout:"total, sizes, prev, pager, next, jumper",pageSizes:[10,20,30,50,100],disabled:!1,hideOnSinglePage:!1,total:10},t(i).pagination));$(()=>t(i).pageSize,a=>{b.value=a}),$(()=>t(i).currentPage,a=>{u.value=a}),$(()=>b.value,a=>{f("update:pageSize",a)}),$(()=>u.value,a=>{f("update:currentPage",a)});const p=R(()=>{const a={...o,...e};return delete a.columns,delete a.data,a}),x=()=>{const{selection:a,reserveSelection:O,align:T,headerAlign:k}=t(i);return a?g(U,{type:"selection",reserveSelection:O,align:T,headerAlign:k,width:"50"},null):void 0},E=()=>{const{align:a,headerAlign:O,expand:T}=t(i);return T?g(U,{type:"expand",align:a,headerAlign:O},{default:k=>D(d,"expand",k)}):void 0},W=a=>{const{columns:O,reserveIndex:T,pageSize:k,currentPage:C,align:j,headerAlign:ae,showOverflowTooltip:de}=t(i);return[E(),x()].concat((a||O).map(s=>{if(s.type==="index")return g(U,{type:"index",index:s.index?s.index:q=>((A,G,J,Q)=>{const H=G+1;return A?J*(Q-1)+H:H})(T,q,k,C),align:s.align||j,headerAlign:s.headerAlign||ae,label:s.label,width:"65px"},null);{const q={...s};return q.children&&delete q.children,g(U,K({showOverflowTooltip:de,align:j,headerAlign:ae},q,{prop:s.field}),{default:A=>{var G;return s.children&&s.children.length?(J=>{const{align:Q,headerAlign:H,showOverflowTooltip:pe}=t(i);return J.map(m=>{const V={...m};return V.children&&delete V.children,g(U,K({showOverflowTooltip:pe,align:Q,headerAlign:H},V,{prop:m.field}),{default:F=>{var ne;return m.children&&m.children.length?W(m.children):D(d,m.field,F)||((ne=m==null?void 0:m.formatter)==null?void 0:ne.call(m,F.row,F.column,F.row[m.field],F.$index))||F.row[m.field]},header:D(d,`${m.field}-header`)})})})(s.children):D(d,s.field,A)||((G=s==null?void 0:s.formatter)==null?void 0:G.call(s,A.row,A.column,A.row[s.field],A.$index))||A.row[s.field]},header:()=>D(d,`${s.field}-header`)||s.label})}}))};return()=>ge(g("div",null,[g(fe,K({ref:w,data:t(i).data,"onSelection-change":r},t(p)),{default:()=>W(),append:()=>D(d,"append")}),t(i).pagination?g(he,K({pageSize:b.value,"onUpdate:pageSize":a=>b.value=a,currentPage:u.value,"onUpdate:currentPage":a=>u.value=a,class:"float-right mt-15px mb-15px"},t(v)),null):void 0]),[[me,t(i).loading]])}}),[["__scopeId","data-v-a2ff9e5d"]]),ee={key:0},te=X({name:"Search"}),re=X({...te,props:{schema:{type:Array,default:()=>[]},isCol:c.bool.def(!1),labelWidth:c.oneOfType([String,Number]).def("auto"),layout:c.string.validate(e=>["inline","bottom"].includes(e)).def("inline"),buttomPosition:c.string.validate(e=>["left","center","right"].includes(e)).def("center"),showSearch:c.bool.def(!0),showReset:c.bool.def(!0),expand:c.bool.def(!1),expandField:c.string.def(""),inline:c.bool.def(!0),model:{type:Object,default:()=>({})}},emits:["search","reset"],setup(e,{emit:o}){const d=e,{t:f}=oe(),h=P(!0),w=R(()=>{let r=we(d.schema);if(d.expand&&d.expandField&&!t(h)){const v=xe(r,p=>p.field===d.expandField);if(v>-1){const p=r.length;r.splice(v+1,p)}}return d.layout==="inline"&&(r=r.concat([{field:"action",formItemProps:{labelWidth:"0px"}}])),r}),{register:b,elFormRef:u,methods:n}=je({model:d.model||{}}),l=async()=>{var r;await((r=t(u))==null?void 0:r.validate(async v=>{if(v){const{getFormData:p}=n,x=await p();o("search",x)}}))},i=async()=>{var p;(p=t(u))==null||p.resetFields();const{getFormData:r}=n,v=await r();o("reset",v)},_=R(()=>({textAlign:d.buttomPosition})),I=()=>{var r;(r=t(u))==null||r.resetFields(),h.value=!t(h)};return(r,v)=>{const p=_e,x=ke,E=Oe;return S(),Y(Se,null,[g(E,{inline:e.inline,"is-col":e.isCol,"is-custom":!1,"label-width":e.labelWidth,schema:t(w),class:"-mb-15px","hide-required-asterisk":"",onRegister:t(b)},be({action:z(()=>[e.layout==="inline"?(S(),Y("div",ee,[e.showSearch?(S(),M(x,{key:0,onClick:l},{default:z(()=>[g(p,{class:"mr-5px",icon:"ep:search"}),N(" "+B(t(f)("common.query")),1)]),_:1})):L("",!0),e.showReset?(S(),M(x,{key:1,onClick:i},{default:z(()=>[g(p,{class:"mr-5px",icon:"ep:refresh"}),N(" "+B(t(f)("common.reset")),1)]),_:1})):L("",!0),e.expand?(S(),M(x,{key:2,text:"",onClick:I},{default:z(()=>[N(B(t(f)(t(h)?"common.shrink":"common.expand"))+" ",1),g(p,{icon:t(h)?"ep:arrow-up":"ep:arrow-down"},null,8,["icon"])]),_:1})):L("",!0),Z(r.$slots,"actionMore")])):L("",!0)]),_:2},[ve(Object.keys(r.$slots),W=>({name:W,fn:z(()=>[Z(r.$slots,W)])}))]),1032,["inline","is-col","label-width","schema","onRegister"]),e.layout==="bottom"?(S(),Y("div",{key:0,style:Pe(t(_))},[e.showSearch?(S(),M(x,{key:0,type:"primary",onClick:l},{default:z(()=>[g(p,{class:"mr-5px",icon:"ep:search"}),N(" "+B(t(f)("common.query")),1)]),_:1})):L("",!0),e.showReset?(S(),M(x,{key:1,onClick:i},{default:z(()=>[g(p,{class:"mr-5px",icon:"ep:refresh-right"}),N(" "+B(t(f)("common.reset")),1)]),_:1})):L("",!0),e.expand?(S(),M(x,{key:2,text:"",onClick:I},{default:z(()=>[N(B(t(f)(t(h)?"common.shrink":"common.expand"))+" ",1),g(p,{icon:t(h)?"ep:arrow-up":"ep:arrow-down"},null,8,["icon"])]),_:1})):L("",!0),Z(r.$slots,"actionMore")],4)):L("",!0)],64)}}}),{t:y}=oe(),ce=e=>{const o=Ae({pageSize:10,currentPage:1,total:10,tableList:[],params:{...(e==null?void 0:e.defaultParams)||{}},loading:!0,exportLoading:!1,currentRow:null}),d=R(()=>({...o.params,pageSize:o.pageSize,pageNo:o.currentPage}));$(()=>o.currentPage,()=>{u.getList()}),$(()=>o.pageSize,()=>{o.currentPage===1||(o.currentPage=1),u.getList()});const f=P(),h=P(),w=async()=>(await ze(),t(f)),b=async n=>{let l=1;n instanceof Array?(l=n.length,await Promise.all(n.map(async i=>{await((e==null?void 0:e.delListApi)&&(e==null?void 0:e.delListApi(i)))}))):await((e==null?void 0:e.delListApi)&&(e==null?void 0:e.delListApi(n))),le.success(y("common.delSuccess")),o.currentPage=(o.total%o.pageSize===l||o.pageSize===1)&&o.currentPage>1?o.currentPage-1:o.currentPage,await u.getList()},u={getList:async()=>{o.loading=!0;const n=await(e==null?void 0:e.getListApi(t(d)).finally(()=>{o.loading=!1}));n&&(o.tableList=n.list,n.total&&(o.total=n.total))},setProps:async(n={})=>{const l=await w();l==null||l.setProps(n)},setColumn:async n=>{const l=await w();l==null||l.setColumn(n)},getSelections:async()=>{const n=await w();return(n==null?void 0:n.selections)||[]},setSearchParams:n=>{o.params=Object.assign(o.params,{pageSize:o.pageSize,pageNo:1,...n}),o.currentPage!==1?o.currentPage=1:u.getList()},delList:async(n,l,i=!0)=>{const _=await w();!l||_!=null&&_.selections.length?i?ie.confirm(y("common.delMessage"),y("common.confirmTitle"),{confirmButtonText:y("common.ok"),cancelButtonText:y("common.cancel"),type:"warning"}).then(async()=>{await b(n)}):await b(n):le.warning(y("common.delNoData"))},exportList:async n=>{o.exportLoading=!0,ie.confirm(y("common.exportMessage"),y("common.confirmTitle"),{confirmButtonText:y("common.ok"),cancelButtonText:y("common.cancel"),type:"warning"}).then(async()=>{var i;const l=await((i=e==null?void 0:e.exportListApi)==null?void 0:i.call(e,t(d)));l&&Re.excel(l,n)}).finally(()=>{o.exportLoading=!1})}};return e!=null&&e.props&&u.setProps(e.props),{register:(n,l)=>{f.value=n,h.value=l},elTableRef:h,tableObject:o,methods:u,tableMethods:u}}});export{re as _,$e as __tla,se as a,ce as u};
