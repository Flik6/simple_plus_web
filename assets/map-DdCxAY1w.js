import{_ as xt,__tla as Mt}from"./Dialog.vue_vue_type_style_index_0_lang-Pdg60xs8.js";import{o as D,c as F,i as kt,ai as W,n as Ct,ay as Bt,G as St,as as Pt,f as It,d as Tt,r as L,ar as Ot,H as Et,w as R,g as O,h as at,a as I,A as tt,X as At,L as Lt,__tla as zt}from"./index-DkWBYEPi.js";import{u as Dt,__tla as Rt}from"./useMessage-CeuPBduw.js";import{_ as Zt}from"./_plugin-vue_export-helper-BCo6x5W8.js";let st,Ft=Promise.all([(()=>{try{return Mt}catch{}})(),(()=>{try{return zt}catch{}})(),(()=>{try{return Rt}catch{}})()]).then(async()=>{var rt={"bm-map":["click","dblclick","rightclick","rightdblclick","maptypechange","mousemove","mouseover","mouseout","movestart","moving","moveend","zoomstart","zoomend","addoverlay","addcontrol","removecontrol","removeoverlay","clearoverlays","dragstart","dragging","dragend","addtilelayer","removetilelayer","load","resize","hotspotclick","hotspotover","hotspotout","tilesloaded","touchstart","touchmove","touchend","longpress"],"bm-geolocation":["locationSuccess","locationError"],"bm-overview-map":["viewchanged","viewchanging"],"bm-marker":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","infowindowclose","infowindowopen","dragstart","dragging","dragend","rightclick"],"bm-polyline":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","lineupdate"],"bm-polygon":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","lineupdate"],"bm-circle":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","lineupdate"],"bm-label":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","rightclick"],"bm-info-window":["close","open","maximize","restore","clickclose"],"bm-ground":["click","dblclick"],"bm-autocomplete":["onconfirm","onhighlight"],"bm-point-collection":["click","mouseover","mouseout"]};function V(e,n){const p=n||rt[this.$options.name];p&&p.forEach(l=>{let u=l.slice(0,2)==="on"?l.slice(2):l;const i=this.$attrs["on"+u.replace(u[0],u[0].toUpperCase())];i&&e.addEventListener(l,i)})}function z(e,n={}){const{lng:p,lat:l}=n;return new e.Point(p,l)}function E(e,n={}){const{width:p,height:l}=n;return new e.Size(p,l)}function U(e,n={}){const{url:p,size:l,opts:u={}}=n;let i={anchor:u.anchor&&E(e,u.anchor),imageSize:u.imageSize&&E(e,u.imageSize),imageOffset:u.imageOffset&&E(e,u.imageOffset),infoWindowAnchor:u.infoWindowAnchor&&E(e,u.infoWindowAnchor),printImageUrl:u.printImageUrl};return G(i),new e.Icon(p,E(e,l),i)}const et=e=>Object.prototype.toString.call(e).slice(8,-1),G=e=>{Object.keys(e).forEach(n=>{e[n]===void 0&&delete e[n]})};let H={v:"3.0",type:"API"};const A=()=>H;var it=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},X={exports:{}};function J(){}J.prototype={on:function(e,n,p){var l=this.e||(this.e={});return(l[e]||(l[e]=[])).push({fn:n,ctx:p}),this},once:function(e,n,p){var l=this;function u(){l.off(e,u),n.apply(p,arguments)}return u._=n,this.on(e,u,p)},emit:function(e){for(var n=[].slice.call(arguments,1),p=((this.e||(this.e={}))[e]||[]).slice(),l=0,u=p.length;l<u;l++)p[l].fn.apply(p[l].ctx,n);return this},off:function(e,n){var p=this.e||(this.e={}),l=p[e],u=[];if(l&&n)for(var i=0,t=l.length;i<t;i++)l[i].fn!==n&&l[i].fn._!==n&&u.push(l[i]);return u.length?p[e]=u:delete p[e],this}},X.exports=J,X.exports.TinyEmitter=J;var Q=new X.exports,Y=(...e)=>Q.on(...e),lt=(...e)=>Q.off(...e),q=(...e)=>Q.emit(...e);const ot={API:{"2.0":{setMapStyle:"setMapStyle",NavigationControl:"NavigationControl"},"3.0":{setMapStyle:"setMapStyleV2",NavigationControl:"NavigationControl"}},WebGL:{setMapStyle:"setMapStyleV2",NavigationControl:"NavigationControl3D"}},K=e=>{const n=A();return n.type=="WebGL"?ot[n.type][e]:ot[n.type][n.v][e]};let nt;new Promise(e=>{nt=e});var N=(e,n)=>{const p=e.__vccOpts||e;for(const[l,u]of n)p[l]=u;return p};const pt={name:"bm-map",inheritAttrs:!1,emits:["ready","init","animationed"],props:{ak:{type:String},v:{type:String},type:{type:String},center:{type:[Object,String]},zoom:{type:Number},minZoom:{type:Number},maxZoom:{type:Number},highResolution:{type:Boolean,default:!0},mapClick:{type:Boolean,default:!0},mapType:{type:String},dragging:{type:Boolean,default:!0},scrollWheelZoom:{type:Boolean,default:!1},doubleClickZoom:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},inertialDragging:{type:Boolean,default:!0},continuousZoom:{type:Boolean,default:!0},pinchToZoom:{type:Boolean,default:!0},autoResize:{type:Boolean,default:!0},theme:{type:Array},mapStyle:{type:Object},hasAnimation:{type:Boolean,default:!0},defaultAnimation:{type:Boolean,default:!0},preserveDrawingBuffer:{type:Boolean,default:!1}},watch:{center(e,n){const{map:p,zoom:l}=this;et(e)==="String"&&e!==n&&this.setCenterZoom(p,e,l)},"center.lng"(e,n){const{BMap:p,map:l,zoom:u,center:i}=this;e!==n&&e>=-180&&e<=180&&this.setCenterZoom(l,new p.Point(e,i.lat),u)},"center.lat"(e,n){const{BMap:p,map:l,zoom:u,center:i}=this;e!==n&&e>=-74&&e<=74&&this.setCenterZoom(l,new p.Point(i.lng,e),u)},zoom(e,n){const{map:p}=this;e!==n&&e>=3&&e<=19&&p.setZoom(e)},minZoom(e){const{map:n}=this;n.setMinZoom(e)},maxZoom(e){const{map:n}=this;n.setMaxZoom(e)},highResolution(){this.reset()},mapClick(){this.reset()},mapType(e){const{map:n}=this;n.setMapType(window[e])},dragging(e){const{map:n}=this;e?n.enableDragging():n.disableDragging()},scrollWheelZoom(e){const{map:n}=this;e?n.enableScrollWheelZoom():n.disableScrollWheelZoom()},doubleClickZoom(e){const{map:n}=this;e?n.enableDoubleClickZoom():n.disableDoubleClickZoom()},keyboard(e){const{map:n}=this;e?n.enableKeyboard():n.disableKeyboard()},inertialDragging(e){const{map:n}=this;e?n.enableInertialDragging():n.disableInertialDragging()},continuousZoom(e){const{map:n}=this;e?n.enableContinuousZoom():n.disableContinuousZoom()},pinchToZoom(e){const{map:n}=this;e?n.enablePinchToZoom():n.disablePinchToZoom()},autoResize(e){const{map:n}=this;e?n.enableAutoResize():n.disableAutoResize()},theme(e){const{map:n}=this;n[K("setMapStyle")]({styleJson:e})},mapStyle:{handler(e){const{map:n,theme:p}=this;!p&&n[K("setMapStyle")](e)},deep:!0}},methods:{setMapOptions(){const{map:e,minZoom:n,maxZoom:p,mapType:l,dragging:u,scrollWheelZoom:i,doubleClickZoom:t,keyboard:o,inertialDragging:s,continuousZoom:h,pinchToZoom:g,autoResize:a}=this;n&&e.setMinZoom(n),p&&e.setMaxZoom(p),l&&e.setMapType(window[l]),u?e.enableDragging():e.disableDragging(),i?e.enableScrollWheelZoom():e.disableScrollWheelZoom(),t?e.enableDoubleClickZoom():e.disableDoubleClickZoom(),o?e.enableKeyboard():e.disableKeyboard(),s?e.enableInertialDragging():e.disableInertialDragging(),h?e.enableContinuousZoom():e.disableContinuousZoom(),g?e.enablePinchToZoom():e.disablePinchToZoom(),a?e.enableAutoResize():e.disableAutoResize()},init(e){if(this.map)return;let n=this.$refs.view;const p=new e.Map(n,{enableHighResolution:this.highResolution,enableMapClick:this.mapClick,preserveDrawingBuffer:this.preserveDrawingBuffer}),l=Math.random().toString();this.mapKey=l,this.map=p;const{setMapOptions:u,zoom:i,getCenterPoint:t,theme:o,mapStyle:s}=this;u(),V.call(this,p),p.reset(),this.setCenterZoom(p,t(),i),o?p[K("setMapStyle")]({styleJson:o}):s&&p[K("setMapStyle")](s);let h=0;this.$emit("init",{BMap:e,map:p,mapKey:l}),q("init",{BMap:e,map:p,mapKey:l}),p.addEventListener("tilesloaded",()=>{h||(h++,this.$emit("ready",{BMap:e,map:p,mapKey:l}),q("ready",{BMap:e,map:p,mapKey:l}))}),p.addEventListener("loaded",()=>{this.$emit("loaded",{BMap:e,map:p,mapKey:l}),q("loaded",{BMap:e,map:p,mapKey:l})})},setCenterZoom(e,n,p){A().type==="WebGL"?this.hasAnimation&&this.defaultAnimation?e.centerAndZoom(n,p):e.setCenter(n,{noAnimation:!this.hasAnimation,callback:()=>{e.setZoom(p,{noAnimation:!this.hasAnimation,zoomCenter:n,callback:()=>{this.$emit("animationed",{BMap:this.BMap,map:e})}})}}):e.centerAndZoom(n,p)},getCenterPoint(){const{center:e,BMap:n}=this;switch(et(e)){case"String":return e;case"Object":return new n.Point(e.lng,e.lat);default:return new n.Point}},initMap(e){this.BMap=e,this.init(e),nt(e)},getMapScript:()=>window.BMap?window.BMap._preloader?window.BMap._preloader:Promise.resolve(window.BMap):(window.BMap={},window.BMap._preloader=new Promise((e,n)=>{window._initBaiduMap=function(){window.BMap=A().type=="WebGL"?window.BMapGL:window.BMap,e(window.BMap),window.document.body.removeChild(p),window.BMap._preloader=null,window._initBaiduMap=null};const p=document.createElement("script");window.document.body.appendChild(p),A().type==="WebGL"?p.src=`https://api.map.baidu.com/api?v=1.0&type=webgl&ak=${A().ak}&callback=_initBaiduMap`:p.src=`https://api.map.baidu.com/api?v=${A().v}&ak=${A().ak}&callback=_initBaiduMap`}),window.BMap._preloader),reset(){const{getMapScript:e,initMap:n}=this;e().then(n)}},created(){const e={};this.ak&&(e.ak=this.ak),this.v&&(e.v=this.v),this.type&&(e.type=this.type),((n={})=>{H=Object.assign(H,n),H.ak})(e)},mounted(){this.reset()},data:()=>({hasBmView:!1,map:null,BMap:null,name:"bm-map",mapKey:""})},ht={key:0,ref:"view",style:{width:"100%",height:"100%"}};var ct=N(pt,[["render",function(e,n,p,l,u,i){return D(),F("div",{class:Ct(e.$attrs.class),style:Bt(e.$attrs.style)},[u.hasBmView?kt("",!0):(D(),F("div",ht,null,512)),W(e.$slots,"default")],6)}]]);const dt={control:{unload:"removeControl"},layer:{unload:"removeTileLayer"},overlay:{unload:"removeOverlay"},contextMenu:{unload:"removeContextMenu"}},Z=e=>e.abstract||e.name!=="bm-map"?Z(e.$parent):e;function ut(){const{unload:e,renderByParent:n,$parent:p,ready:l}=this;lt("ready",l),n&&p.reload(),e()}const mt=(e={})=>({emits:["ready","init"],computed:{renderByParent(){return this.$parent.preventChildrenRender}},created(){const n=Z(this.$parent),p=n.map,{ready:l,_init:u}=this;p?l():Y("ready",({mapKey:i})=>this.emitCallBack(i,l)),p?this.init({BMap:n.BMap,map:p}):Y("init",({mapKey:i})=>this.emitCallBack(i,u))},mounted(){const n=Z(this.$parent).map,{mountedReady:p}=this;n?p():Y("ready",({mapKey:l})=>this.emitCallBack(l,p))},unmounted:ut,methods:{emitCallBack(n,p){n==Z(this.$parent).mapKey&&p()},_init(){const n=Z(this.$parent),p=this.BMap=n.BMap,l=this.map=n.map;this.init({BMap:p,map:l})},init(){},ready(){const n=Z(this.$parent),p=this.BMap=n.BMap,l=this.map=n.map;this.load(),this.$emit("ready",{BMap:p,map:l})},mountedReady(){this.mountedLoad()},transmitEvent(n){this.$emit(n.type.replace(/^on/,""),n)},reload(){this&&this.BMap&&this.$nextTick(()=>{this.unload(),this.$nextTick(()=>{this.load(),this.mountedLoad()})})},unload(){const{map:n,originInstance:p}=this;try{switch(e.type){case"search":return p.clearResults();case"autoComplete":case"lushu":return p.dispose();case"markerClusterer":return p.clearMarkers();default:n[dt[e.type].unload](p)}}catch{}},mountedLoad(){}}});var $=e=>mt({type:e});const gt={name:"bm-geolocation",render(){},mixins:[$("control")],props:{anchor:{type:String},offset:{type:Object},showAddressBar:{type:Boolean},autoLocation:{type:Boolean},locationIcon:{type:Object}},watch:{anchor(){this.reload()},offset(){this.reload()},showAddressBar(){this.reload()},autoLocation(){this.reload()},locationIcon(){this.reload()}},methods:{load(){const{BMap:e,map:n,anchor:p,showAddressBar:l,autoLocation:u,locationIcon:i,offset:t}=this;let o={anchor:window[p],showAddressBar:l,enableAutoLocation:u,offset:t&&E(e,t),locationIcon:i&&U(e,i)};G(o),A().type==="WebGL"?this.originInstance=new e.LocationControl(o):this.originInstance=new e.GeolocationControl(o),V.call(this,this.originInstance),n.addControl(this.originInstance)}}};var ft=N({name:"bm-control",mixins:[$("control")],props:["anchor","offset"],watch:{anchor(e){this.originInstance.setAnchor(e)},offset(e){this.originInstance.setOffset(e)}},methods:{load(){const{BMap:e,map:n,anchor:p,offset:l,$el:u}=this,i=function(){this.defaultAnchor=window[p||"BMAP_ANCHOR_TOP_LEFT"],this.defaultOffset=E(e,l)};(i.prototype=new e.Control).initialize=t=>t.getContainer().appendChild(u),this.originInstance=new i,n.addControl(this.originInstance)}}},[["render",function(e,n,p,l,u,i){return D(),F("div",null,[W(e.$slots,"default")])}]]),yt=N({name:"bm-marker",mixins:[$("overlay")],inject:{Cluster:{default:()=>({})}},props:{position:{},offset:{},icon:{},massClear:{type:Boolean,default:!0},dragging:{type:Boolean,default:!1},clicking:{type:Boolean,default:!0},raiseOnDrag:{type:Boolean,default:!1},draggingCursor:{type:String},rotation:{type:Number},shadow:{type:Object},title:{type:String},label:{type:Object},animation:{type:String},top:{type:Boolean,default:!1},zIndex:{type:Number,default:0}},watch:{"position.lng"(e,n){const{BMap:p,originInstance:l,position:u,renderByParent:i,$parent:t}=this;e!==n&&e>=-180&&e<=180&&l.setPosition(z(p,{lng:e,lat:u.lat})),i&&t.reload()},"position.lat"(e,n){const{BMap:p,originInstance:l,position:u,renderByParent:i,$parent:t}=this;e!==n&&e>=-74&&e<=74&&l.setPosition(z(p,{lng:u.lng,lat:e})),i&&t.reload()},"offset.width"(e,n){const{BMap:p,originInstance:l}=this;e!==n&&l.setOffset(new p.Size(e,this.offset.height))},"offset.height"(e,n){const{BMap:p,originInstance:l}=this;e!==n&&l.setOffset(new p.Size(this.offset.width,e))},icon:{deep:!0,handler(e){const{BMap:n,originInstance:p,rotation:l}=this;p&&p.setIcon(U(n,e)),l&&p&&p.setRotation(l)}},massClear(e){e?this.originInstance.enableMassClear():this.originInstance.disableMassClear()},dragging(e){e?this.originInstance.enableDragging():this.originInstance.disableDragging()},clicking(){this.reload()},raiseOnDrag(){this.reload()},draggingCursor(e){this.originInstance.setDraggingCursor(e)},rotation(e){this.originInstance.setRotation(e)},shadow(e){this.originInstance.setShadow(e)},title(e){this.originInstance.setTitle(e)},label(e){this.reload()},animation(e){this.originInstance.setAnimation(window[e])},top(e){this.originInstance.setTop(e)},zIndex(e){this.originInstance.setZIndex(e)}},methods:{load(){var e,n;const{BMap:p,map:l,position:u,offset:i,icon:t,massClear:o,dragging:s,clicking:h,raiseOnDrag:g,draggingCursor:a,rotation:c,shadow:f,title:y,label:x,animation:d,top:w,renderByParent:B,$parent:P,zIndex:M}=this;let r={offset:i,icon:t&&U(p,t),enableMassClear:o,enableDragging:s,enableClicking:h,raiseOnDrag:g,draggingCursor:a,rotation:c,shadow:f,title:y};G(r);const m=new p.Marker(new p.Point(u.lng,u.lat),r);this.originInstance=m,x&&m&&m.setLabel(function(_,b={}){const{content:v,opts:S}=b;let k={offset:S.offset&&E(_,S.offset),position:S.position&&z(_,S.position),enableMassClear:S.enableMassClear};return G(k),new _.Label(v,k)}(p,x)),m.setTop(w),m.setZIndex(M),V.call(this,m),B?P.reload():l.addOverlay(m),m.setAnimation(window[d]),(n=(e=this.Cluster)==null?void 0:e.addMaker)==null||n.call(e,this)}},beforeUnmount(){var e,n;(n=(e=this.Cluster)==null?void 0:e.removeMaker)==null||n.call(e,this)}},[["render",function(e,n,p,l,u,i){return D(),F("div",null,[W(e.$slots,"default")])}]]),_t=N({name:"bm-local-search",emits:["markersset","infohtmlset","resultshtmlset","searchcomplete"],mixins:[$("search")],props:{location:{type:[Object,String]},keyword:{type:[Array,String]},panel:{type:Boolean,default:!0},forceLocal:{type:Boolean},customData:{type:Object},bounds:{type:Object},nearby:{type:Object},pageCapacity:{type:Number},autoViewport:{type:Boolean},selectFirstResult:{type:Boolean}},watch:{location:{handler(e){const{originInstance:n,search:p}=this;n.setLocation(e||this.map),p()},deep:!0},keyword(){this.search()},bounds:{handler(e){const{searchInBounds:n}=this;n(e)},deep:!0},nearby:{handler(e){const{searchNearby:n}=this;n(e)},deep:!0},forceLocal(){this.reload()},customData:{deep:!0,handler(){this.reload()}},pageCapacity(e){this.originInstance&&this.originInstance.setPageCapacity(e)},autoViewport(e){this.originInstance&&(e?this.originInstance.enableAutoViewport():this.originInstance.disableAutoViewport())},selectFirstResult(e){this.originInstance&&(e?this.originInstance.enableFirstResultSelection():this.originInstance.disableFirstResultSelection())},highlightMode(){this.reload()}},methods:{searchNearby(e){const{originInstance:n,keyword:p,customData:l,BMap:u}=this;n.searchNearby(p,z(u,e.center),e.radius,l)},searchInBounds(e){const{originInstance:n,keyword:p,customData:l,BMap:u}=this;n.searchInBounds(p,function(i,t={}){const{sw:o,ne:s}=t;return new i.Bounds(z(i,o),z(i,s))}(u,e),l)},search(){const{originInstance:e,keyword:n,forceLocal:p,customData:l,nearby:u,bounds:i,searchNearby:t,searchInBounds:o}=this;u?t(u):i?o(i):e.search(n,{forceLocal:p,customData:l})},load(){const e=this,{map:n,BMap:p,search:l,pageCapacity:u,autoViewport:i,selectFirstResult:t,highlightMode:o,location:s,originInstance:h}=this,g=s?(a=s).lng&&a.lat?z(p,s):s:n;var a;const c=this.originInstance=new p.LocalSearch(g,{onMarkersSet(f){e.$emit("markersset",f)},onInfoHtmlSet(f){e.$emit("infohtmlset",f)},onResultsHtmlSet(f){e.$emit("resultshtmlset",f)},onSearchComplete(f){h&&h!==c&&h.clearResults(),e.$emit("searchcomplete",f)},pageCapacity:u,renderOptions:{map:n,panel:this.$el,selectFirstResult:t,autoViewport:i,highlightMode:o}});l()}}},[["render",function(e,n,p,l,u,i){return St((D(),F("div",null,[W(e.$slots,"default")],512)),[[Pt,p.panel]])}]]);const vt={name:"bm-autocomplete",mixins:[$("autoComplete")],emits:["update:modelValue","searchcomplete"],props:{types:{type:String},location:{type:String},sugStyle:{type:Object,default:()=>({})},modelValue:{}},watch:{types(){this.reload()},location(){this.reload()}},methods:{load(){const{BMap:e,map:n,$el:p,types:l,location:u,sugStyle:i}=this,t=p.querySelector("input");t&&(this.originInstance=new e.Autocomplete({input:t,types:l,location:u||n,onSearchComplete:o=>{const s=document.querySelectorAll(".tangram-suggestion-main");for(const h of s)for(const g in i)h.style[g]=i[g].toString();this.$emit("searchcomplete",o)}}),this.originInstance.addEventListener("onconfirm",o=>{const s=o.item.value;this.$emit("update:modelValue",s.province+s.city+s.district+s.street+s.business)}),V.call(this,this.originInstance))}}},bt=It("input",null,null,-1);var wt=N(vt,[["render",function(e,n,p,l,u,i){return D(),F("span",null,[W(e.$slots,"default",{},()=>[bt])])}]]);(function(){var e=typeof window<"u"?window:it!==void 0?it:this;function n(a,c){return a(c={exports:{}},c.exports,e),c.exports}var p=n(function(a,c,f){(function(y,x){typeof c=="object"?a.exports=x():(y.BMapLib=y.BMapLib||{},y.BMapLib.TextIconOverlay=y.BMapLib.TextIconOverlay||x())})(e,function(){var y,x,d=y=d||{version:"1.3.8"},w={};d.guid="$BAIDU$",w[d.guid]=w[d.guid]||{},d.dom=d.dom||{},d.dom.g=function(r){return typeof r=="string"||r instanceof String?document.getElementById(r):r&&r.nodeName&&(r.nodeType==1||r.nodeType==9)?r:null},d.g=d.G=d.dom.g,d.dom.getDocument=function(r){return(r=d.dom.g(r)).nodeType==9?r:r.ownerDocument||r.document},d.lang=d.lang||{},d.lang.isString=function(r){return Object.prototype.toString.call(r)=="[object String]"},d.isString=d.lang.isString,d.dom._g=function(r){return d.lang.isString(r)?document.getElementById(r):r},d._g=d.dom._g,d.browser=d.browser||{},/msie (\d+\.\d)/i.test(navigator.userAgent)&&(d.browser.ie=d.ie=document.documentMode||+RegExp.$1),d.dom.getComputedStyle=function(r,m){r=d.dom._g(r);var _,b=d.dom.getDocument(r);return b.defaultView&&b.defaultView.getComputedStyle&&(_=b.defaultView.getComputedStyle(r,null))?_[m]||_.getPropertyValue(m):""},d.dom._styleFixer=d.dom._styleFixer||{},d.dom._styleFilter=d.dom._styleFilter||[],d.dom._styleFilter.filter=function(r,m,_){for(var b,v=0,S=d.dom._styleFilter;b=S[v];v++)(b=b[_])&&(m=b(r,m));return m},d.string=d.string||{},d.string.toCamelCase=function(r){return r.indexOf("-")<0&&r.indexOf("_")<0?r:r.replace(/[-_][^-_]/g,function(m){return m.charAt(1).toUpperCase()})},d.dom.getStyle=function(r,m){var _=d.dom;r=_.g(r),m=d.string.toCamelCase(m);var b=r.style[m]||(r.currentStyle?r.currentStyle[m]:"")||_.getComputedStyle(r,m);if(!b){var v=_._styleFixer[m];v&&(b=v.get?v.get(r):d.dom.getStyle(r,v))}return(v=_._styleFilter)&&(b=v.filter(m,b,"get")),b},d.getStyle=d.dom.getStyle,/opera\/(\d+\.\d)/i.test(navigator.userAgent)&&(d.browser.opera=+RegExp.$1),d.browser.isWebkit=/webkit/i.test(navigator.userAgent),d.browser.isGecko=/gecko/i.test(navigator.userAgent)&&!/like gecko/i.test(navigator.userAgent),d.browser.isStrict=document.compatMode=="CSS1Compat",d.dom.getPosition=function(r){r=d.dom.g(r);var m=d.dom.getDocument(r),_=d.browser,b=d.dom.getStyle;_.isGecko>0&&m.getBoxObjectFor&&b(r,"position")=="absolute"&&(r.style.top===""||r.style.left);var v,S,k={left:0,top:0};if(r==(_.ie&&!_.isStrict?m.body:m.documentElement))return k;if(r.getBoundingClientRect){S=r.getBoundingClientRect(),k.left=Math.floor(S.left)+Math.max(m.documentElement.scrollLeft,m.body.scrollLeft),k.top=Math.floor(S.top)+Math.max(m.documentElement.scrollTop,m.body.scrollTop),k.left-=m.documentElement.clientLeft,k.top-=m.documentElement.clientTop;var C=m.body,T=parseInt(b(C,"borderLeftWidth")),j=parseInt(b(C,"borderTopWidth"));_.ie&&!_.isStrict&&(k.left-=isNaN(T)?2:T,k.top-=isNaN(j)?2:j)}else{v=r;do{if(k.left+=v.offsetLeft,k.top+=v.offsetTop,_.isWebkit>0&&b(v,"position")=="fixed"){k.left+=m.body.scrollLeft,k.top+=m.body.scrollTop;break}v=v.offsetParent}while(v&&v!=r);for((_.opera>0||_.isWebkit>0&&b(r,"position")=="absolute")&&(k.top-=m.body.offsetTop),v=r.offsetParent;v&&v!=m.body;)k.left-=v.scrollLeft,_.opera&&v.tagName=="TR"||(k.top-=v.scrollTop),v=v.offsetParent}return k},d.event=d.event||{},d.event._listeners=d.event._listeners||[],d.event.on=function(r,m,_){m=m.replace(/^on/i,""),r=d.dom._g(r);var b,v=function(T){_.call(r,T)},S=d.event._listeners,k=d.event._eventFilter,C=m;return m=m.toLowerCase(),k&&k[m]&&(C=(b=k[m](r,m,v)).type,v=b.listener),r.addEventListener?r.addEventListener(C,v,!1):r.attachEvent&&r.attachEvent("on"+C,v),S[S.length]=[r,m,_,v,C],r},d.on=d.event.on,x=w[d.guid],d.lang.guid=function(){return"TANGRAM__"+(x._counter++).toString(36)},x._counter=x._counter||1,w[d.guid]._instances=w[d.guid]._instances||{},d.lang.isFunction=function(r){return Object.prototype.toString.call(r)=="[object Function]"},d.lang.Class=function(r){this.guid=r||d.lang.guid(),w[d.guid]._instances[this.guid]=this},w[d.guid]._instances=w[d.guid]._instances||{},d.lang.Class.prototype.dispose=function(){for(var r in delete w[d.guid]._instances[this.guid],this)d.lang.isFunction(this[r])||delete this[r];this.disposed=!0},d.lang.Class.prototype.toString=function(){return"[object "+(this._className||"Object")+"]"},d.lang.Event=function(r,m){this.type=r,this.returnValue=!0,this.target=m||null,this.currentTarget=null},d.lang.Class.prototype.addEventListener=function(r,m,_){if(d.lang.isFunction(m)){!this.__listeners&&(this.__listeners={});var b,v=this.__listeners;if(typeof _=="string"&&_){if(/[^\w\-]/.test(_))throw"nonstandard key:"+_;m.hashCode=_,b=_}r.indexOf("on")!=0&&(r="on"+r),typeof v[r]!="object"&&(v[r]={}),b=b||d.lang.guid(),m.hashCode=b,v[r][b]=m}},d.lang.Class.prototype.removeEventListener=function(r,m){if(m===void 0||(!d.lang.isFunction(m)||(m=m.hashCode))&&d.lang.isString(m)){!this.__listeners&&(this.__listeners={}),r.indexOf("on")!=0&&(r="on"+r);var _=this.__listeners;if(_[r])if(m!==void 0)_[r][m]&&delete _[r][m];else for(var b in _[r])delete _[r][b]}},d.lang.Class.prototype.dispatchEvent=function(r,m){for(var _ in d.lang.isString(r)&&(r=new d.lang.Event(r)),!this.__listeners&&(this.__listeners={}),m=m||{})r[_]=m[_];var b=this.__listeners,v=r.type;if(r.target=r.target||this,r.currentTarget=this,v.indexOf("on")!=0&&(v="on"+v),d.lang.isFunction(this[v])&&this[v].apply(this,arguments),typeof b[v]=="object")for(_ in b[v])b[v][_].apply(this,arguments);return r.returnValue},d.lang.inherits=function(r,m,_){var b,v,S=r.prototype,k=new Function;for(b in k.prototype=m.prototype,v=r.prototype=new k,S)v[b]=S[b];r.prototype.constructor=r,r.superClass=m.prototype,typeof _=="string"&&(v._className=_)},d.inherits=d.lang.inherits;var B="http://api.map.baidu.com/library/TextIconOverlay/1.2/src/images/m",P="png",M=function(r,m,_){try{BMap}catch{throw Error("Baidu Map JS API is not ready yet!")}y.lang.inherits(M,BMap.Overlay,"TextIconOverlay"),this._position=r,this._text=m,this._options=_||{},this._styles=this._options.styles||[],!this._styles.length&&this._setupDefaultStyles()};return M.prototype._setupDefaultStyles=function(){for(var r,m=[53,56,66,78,90],_=0;r=m[_];_++)this._styles.push({url:B+_+"."+P,size:new BMap.Size(r,r)})},M.prototype.initialize=function(r){return this._map=r,this._domElement=document.createElement("div"),this._updateCss(),this._updateText(),this._updatePosition(),this._bind(),this._map.getPanes().markerMouseTarget.appendChild(this._domElement),this._domElement},M.prototype.draw=function(){this._map&&this._updatePosition()},M.prototype.getText=function(){return this._text},M.prototype.setText=function(r){!r||this._text&&this._text.toString()==r.toString()||(this._text=r,this._updateText(),this._updateCss(),this._updatePosition())},M.prototype.getPosition=function(){return this._position},M.prototype.setPosition=function(r){!r||this._position&&this._position.equals(r)||(this._position=r,this._updatePosition())},M.prototype.getStyleByText=function(r,m){var _=parseInt(r),b=parseInt(_/10);return b=Math.max(0,b),m[b=Math.min(b,m.length-1)]},M.prototype._updateCss=function(){if(this._domElement){var r=this.getStyleByText(this._text,this._styles);this._domElement.style.cssText=this._buildCssText(r)}},M.prototype._updateText=function(){this._domElement&&(this._domElement.innerHTML=this._text)},M.prototype._updatePosition=function(){if(this._domElement&&this._position){var r=this._domElement.style,m=this._map.pointToOverlayPixel(this._position);m.x-=Math.ceil(parseInt(r.width)/2),m.y-=Math.ceil(parseInt(r.height)/2),r.left=m.x+"px",r.top=m.y+"px"}},M.prototype._buildCssText=function(r){var m=r.url,_=r.size,b=r.anchor,v=r.offset,S=r.textColor||"black",k=r.textSize||10,C=[];if(y.browser.ie<7)C.push('filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,src="'+m+'");');else{C.push("background-image:url("+m+");");var T="0 0";v instanceof BMap.Size&&(T=v.width+"px "+v.height+"px"),C.push("background-position:"+T+";")}return _ instanceof BMap.Size&&(b instanceof BMap.Size?(b.height>0&&b.height<_.height&&C.push("height:"+(_.height-b.height)+"px; padding-top:"+b.height+"px;"),b.width>0&&b.width<_.width&&C.push("width:"+(_.width-b.width)+"px; padding-left:"+b.width+"px;")):(C.push("height:"+_.height+"px; line-height:"+_.height+"px;"),C.push("width:"+_.width+"px; text-align:center;"))),C.push("cursor:pointer; color:"+S+"; position:absolute; font-size:"+k+"px; font-family:Arial,sans-serif; font-weight:bold"),C.join("")},M.prototype._bind=function(){if(this._domElement){var r=this,m=this._map,_=y.lang.Event;y.event.on(this._domElement,"mouseover",function(v){r.dispatchEvent(b(v,new _("onmouseover")))}),y.event.on(this._domElement,"mouseout",function(v){r.dispatchEvent(b(v,new _("onmouseout")))}),y.event.on(this._domElement,"click",function(v){r.dispatchEvent(b(v,new _("onclick")))})}function b(v,S){var k=v.srcElement||v.target,C=v.clientX||v.pageX,T=v.clientY||v.pageY;if(v&&S&&C&&T&&k){var j=y.dom.getPosition(m.getContainer());S.pixel=new BMap.Pixel(C-j.left,T-j.top),S.point=m.pixelToPoint(S.pixel)}return S}},M})}),l=p&&typeof p=="object"&&"default"in p?p.default:p,u=function(a,c,f){c=i(c);var y=a.pointToPixel(c.getNorthEast()),x=a.pointToPixel(c.getSouthWest());y.x+=f,y.y-=f,x.x-=f,x.y+=f;var d=a.pixelToPoint(y),w=a.pixelToPoint(x);return new BMap.Bounds(w,d)},i=function(a){var c=t(a.getNorthEast().lng,-180,180),f=t(a.getSouthWest().lng,-180,180),y=t(a.getNorthEast().lat,-74,74),x=t(a.getSouthWest().lat,-74,74);return new BMap.Bounds(new BMap.Point(f,x),new BMap.Point(c,y))},t=function(a,c,f){return c&&(a=Math.max(a,c)),f&&(a=Math.min(a,f)),a},o=function(a){return Object.prototype.toString.call(a)==="[object Array]"},s=function(a,c){var f=-1;if(o(c)){if(c.indexOf)f=c.indexOf(a);else for(var y,x=0;y=c[x];x++)if(y===a){f=x;break}}return f},h=function(a,c){try{BMap}catch{throw Error("Baidu Map JS API is not ready yet!")}if(a){this._map=a,this._markers=[],this._clusters=[];var f=c||{};this._gridSize=f.gridSize||60,this._maxZoom=f.maxZoom||18,this._minClusterSize=f.minClusterSize||2,this._isAverageCenter=!1,f.isAverageCenter!=null&&(this._isAverageCenter=f.isAverageCenter),this._styles=f.styles||[];var y=this;this._map.addEventListener("zoomend",function(){y._redraw()}),this._map.addEventListener("moveend",function(){y._redraw()});var x=f.markers;o(x)&&this.addMarkers(x)}};function g(a){this._markerClusterer=a,this._map=a.getMap(),this._minClusterSize=a.getMinClusterSize(),this._isAverageCenter=a.isAverageCenter(),this._center=null,this._markers=[],this._gridBounds=null,this._isReal=!1,this._clusterMarker=new l(this._center,this._markers.length,{styles:this._markerClusterer.getStyles()})}h.prototype.addMarkers=function(a){if(a.length){for(var c=0,f=a.length;c<f;c++)this._pushMarkerTo(a[c]);this._createClusters()}},h.prototype._pushMarkerTo=function(a){s(a,this._markers)===-1&&(a.isInCluster=!1,this._markers.push(a))},h.prototype.addMarker=function(a){this._pushMarkerTo(a),this._createClusters()},h.prototype._createClusters=function(){var a=this._map.getBounds();if(a.getCenter())for(var c,f=u(this._map,a,this._gridSize),y=0;c=this._markers[y];y++)!c.isInCluster&&f.containsPoint(c.getPosition())&&this._addToClosestCluster(c)},h.prototype._addToClosestCluster=function(a){var c=4e6,f=null;a.getPosition();for(var y,x=0;y=this._clusters[x];x++){var d=y.getCenter();if(d){var w=this._map.getDistance(d,a.getPosition());w<c&&(c=w,f=y)}}f&&f.isMarkerInClusterBounds(a)?f.addMarker(a):((y=new g(this)).addMarker(a),this._clusters.push(y))},h.prototype._clearLastClusters=function(){for(var a,c=0;a=this._clusters[c];c++)a.remove();this._clusters=[],this._removeMarkersFromCluster()},h.prototype._removeMarkersFromCluster=function(){for(var a,c=0;a=this._markers[c];c++)a.isInCluster=!1},h.prototype._removeMarkersFromMap=function(){for(var a,c=0;a=this._markers[c];c++){a.isInCluster=!1;var f=a.getLabel();this._map.removeOverlay(a),a.setLabel(f)}},h.prototype._removeMarker=function(a){var c=s(a,this._markers);return c!==-1&&(this._map.removeOverlay(a),this._markers.splice(c,1),!0)},h.prototype.removeMarker=function(a){var c=this._removeMarker(a);return c&&(this._clearLastClusters(),this._createClusters()),c},h.prototype.removeMarkers=function(a){for(var c=!1,f=0;f<a.length;f++){var y=this._removeMarker(a[f]);c=c||y}return c&&(this._clearLastClusters(),this._createClusters()),c},h.prototype.clearMarkers=function(){this._clearLastClusters(),this._removeMarkersFromMap(),this._markers=[]},h.prototype._redraw=function(){this._clearLastClusters(),this._createClusters()},h.prototype.getGridSize=function(){return this._gridSize},h.prototype.setGridSize=function(a){this._gridSize=a,this._redraw()},h.prototype.getMaxZoom=function(){return this._maxZoom},h.prototype.setMaxZoom=function(a){this._maxZoom=a,this._redraw()},h.prototype.getStyles=function(){return this._styles},h.prototype.setStyles=function(a){this._styles=a,this._redraw()},h.prototype.getMinClusterSize=function(){return this._minClusterSize},h.prototype.setMinClusterSize=function(a){this._minClusterSize=a,this._redraw()},h.prototype.isAverageCenter=function(){return this._isAverageCenter},h.prototype.getMap=function(){return this._map},h.prototype.getMarkers=function(){return this._markers},h.prototype.getClustersCount=function(){for(var a,c=0,f=0;a=this._clusters[f];f++)a.isReal()&&c++;return c},g.prototype.addMarker=function(a){if(this.isMarkerInCluster(a))return!1;if(this._center){if(this._isAverageCenter){var c=this._markers.length+1,f=(this._center.lat*(c-1)+a.getPosition().lat)/c,y=(this._center.lng*(c-1)+a.getPosition().lng)/c;this._center=new BMap.Point(y,f),this.updateGridBounds()}}else this._center=a.getPosition(),this.updateGridBounds();a.isInCluster=!0,this._markers.push(a);var x=this._markers.length;if(x<this._minClusterSize)return this._map.addOverlay(a),!0;if(x===this._minClusterSize)for(var d=0;d<x;d++){var w=this._markers[d].getLabel();this._markers[d].getMap()&&this._map.removeOverlay(this._markers[d]),this._markers[d].setLabel(w)}return this._map.addOverlay(this._clusterMarker),this._isReal=!0,this.updateClusterMarker(),!0},g.prototype.isMarkerInCluster=function(a){if(this._markers.indexOf)return this._markers.indexOf(a)!=-1;for(var c,f=0;c=this._markers[f];f++)if(c===a)return!0;return!1},g.prototype.isMarkerInClusterBounds=function(a){return this._gridBounds.containsPoint(a.getPosition())},g.prototype.isReal=function(a){return this._isReal},g.prototype.updateGridBounds=function(){var a=new BMap.Bounds(this._center,this._center);this._gridBounds=u(this._map,a,this._markerClusterer.getGridSize())},g.prototype.updateClusterMarker=function(){if(this._map.getZoom()>this._markerClusterer.getMaxZoom()){this._clusterMarker&&this._map.removeOverlay(this._clusterMarker);for(var a,c=0;a=this._markers[c];c++)this._map.addOverlay(a)}else this._markers.length<this._minClusterSize?this._clusterMarker.hide():(this._clusterMarker.setPosition(this._center),this._clusterMarker.setText(this._markers.length),this._clusterMarker.addEventListener&&!this._clusterMarker._hasClickEvent&&this._clusterMarker.addEventListener("click",(function(f){this._clusterMarker._hasClickEvent=!0,this._markers&&this._map.setViewport(this.getBounds())}).bind(this)))},g.prototype.remove=function(){for(var a=0;this._markers[a];a++){var c=this._markers[a].getLabel();this._markers[a].getMap()&&this._map.removeOverlay(this._markers[a]),this._markers[a].setLabel(c)}this._map.removeOverlay(this._clusterMarker),this._markers.length=0,delete this._markers},g.prototype.getBounds=function(){for(var a,c=new BMap.Bounds(this._center,this._center),f=0;a=this._markers[f];f++)c.extend(a.getPosition());return c},g.prototype.getCenter=function(){return this._center}})(),function(){var e,n={dom:{}};n.dom.g=function(i){return typeof i=="string"||i instanceof String?document.getElementById(i):i&&i.nodeName&&(i.nodeType==1||i.nodeType==9)?i:null},n.g=n.G=n.dom.g,n.lang=n.lang||{},n.lang.isString=function(i){return Object.prototype.toString.call(i)=="[object String]"},n.isString=n.lang.isString,n.dom._g=function(i){return n.lang.isString(i)?document.getElementById(i):i},n._g=n.dom._g,n.dom.getDocument=function(i){return(i=n.dom.g(i)).nodeType==9?i:i.ownerDocument||i.document},n.browser=n.browser||{},n.browser.ie=n.ie=/msie (\d+\.\d+)/i.test(navigator.userAgent)?document.documentMode||+RegExp.$1:void 0,n.dom.getComputedStyle=function(i,t){i=n.dom._g(i);var o,s=n.dom.getDocument(i);return s.defaultView&&s.defaultView.getComputedStyle&&(o=s.defaultView.getComputedStyle(i,null))?o[t]||o.getPropertyValue(t):""},n.dom._styleFixer=n.dom._styleFixer||{},n.dom._styleFilter=n.dom._styleFilter||[],n.dom._styleFilter.filter=function(i,t,o){for(var s,h=0,g=n.dom._styleFilter;s=g[h];h++)(s=s[o])&&(t=s(i,t));return t},n.string=n.string||{},n.string.toCamelCase=function(i){return i.indexOf("-")<0&&i.indexOf("_")<0?i:i.replace(/[-_][^-_]/g,function(t){return t.charAt(1).toUpperCase()})},n.dom.getStyle=function(i,t){var o=n.dom;i=o.g(i),t=n.string.toCamelCase(t);var s=i.style[t]||(i.currentStyle?i.currentStyle[t]:"")||o.getComputedStyle(i,t);if(!s){var h=o._styleFixer[t];h&&(s=h.get?h.get(i):n.dom.getStyle(i,h))}return(h=o._styleFilter)&&(s=h.filter(t,s,"get")),s},n.getStyle=n.dom.getStyle,n.dom._NAME_ATTRS=(e={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",usemap:"useMap",frameborder:"frameBorder"},n.browser.ie<8?(e.for="htmlFor",e.class="className"):(e.htmlFor="for",e.className="class"),e),n.dom.setAttr=function(i,t,o){return i=n.dom.g(i),t=="style"?i.style.cssText=o:(t=n.dom._NAME_ATTRS[t]||t,i.setAttribute(t,o)),i},n.setAttr=n.dom.setAttr,n.dom.setAttrs=function(i,t){for(var o in i=n.dom.g(i),t)n.dom.setAttr(i,o,t[o]);return i},n.setAttrs=n.dom.setAttrs,n.dom.create=function(i,t){var o=document.createElement(i),s=t||{};return n.dom.setAttrs(o,s)},n.object=n.object||{},n.extend=n.object.extend=function(i,t){for(var o in t)t.hasOwnProperty(o)&&(i[o]=t[o]);return i};var p=function(i,t,o){try{BMap}catch{throw Error("Baidu Map JS API is not ready yet!")}!t||t.length<1||(this._map=i,this._path=t,this.i=0,this._setTimeoutQuene=[],this._projection=this._map.getMapType().getProjection(),this._opts={icon:null,speed:4e3,defaultContent:"",showInfoWindow:!1},this._setOptions(o),this._rotation=0,!this._opts.icon instanceof BMap.Icon&&(this._opts.icon=defaultIcon))};function l(i,t){this._point=i,this._html=t}function u(){l.prototype=new BMap.Overlay,l.prototype.initialize=function(i){var t=this._div=n.dom.create("div",{style:"border:solid 1px #ccc;width:auto;min-width:50px;text-align:center;position:absolute;background:#fff;color:#000;font-size:12px;border-radius: 10px;padding:5px;white-space: nowrap;"});return t.innerHTML=this._html,i.getPanes().floatPane.appendChild(t),this._map=i,t},l.prototype.draw=function(){this.setPosition(this.lushuMain._marker.getPosition(),this.lushuMain._marker.getIcon().size)},n.object.extend(l.prototype,{setPosition:function(i,t){var o=this._map.pointToOverlayPixel(i),s=n.dom.getStyle(this._div,"width"),h=n.dom.getStyle(this._div,"height"),g=parseInt(this._div.clientWidth||s,10);parseInt(this._div.clientHeight||h,10),this._div.style.left=o.x-g/2+"px",this._div.style.bottom=-(o.y-t.height)+"px"},setHtml:function(i){this._div.innerHTML=i},setRelatedClass:function(i){this.lushuMain=i}})}p.prototype._setOptions=function(i){if(i)for(var t in i)i.hasOwnProperty(t)&&(this._opts[t]=i[t])},p.prototype.start=function(){var i=this,t=i._path.length;if(this._opts.onstart&&this._opts.onstart(i),i.i&&i.i<t-1){if(!i._fromPause)return;i._fromStop||i._moveNext(++i.i)}else!i._marker&&i._addMarker(),i._timeoutFlag=setTimeout(function(){!i._overlay&&i._addInfoWin(),i._moveNext(i.i)},400);this._fromPause=!1,this._fromStop=!1},p.prototype.stop=function(){this.i=0,this._fromStop=!0,clearInterval(this._intervalFlag),this._clearTimeout();for(var i=0,t=this._opts.landmarkPois,o=t.length;i<o;i++)t[i].bShow=!1;this._opts.onstop&&this._opts.onstop(this)},p.prototype.pause=function(){clearInterval(this._intervalFlag),this._fromPause=!0,this._clearTimeout(),this._opts.onpause&&this._opts.onpause(this)},p.prototype.hideInfoWindow=function(){this._opts.showInfoWindow=!1,this._overlay&&(this._overlay._div.style.visibility="hidden")},p.prototype.showInfoWindow=function(){this._opts.showInfoWindow=!0,this._overlay&&(this._overlay._div.style.visibility="visible")},p.prototype.dispose=function(){clearInterval(this._intervalFlag),this._setTimeoutQuene&&this._clearTimeout(),this._map&&(this._map.removeOverlay(this._overlay),this._map.removeOverlay(this._marker))},n.object.extend(p.prototype,{_addMarker:function(i){this._marker&&(this.stop(),this._map.removeOverlay(this._marker),clearTimeout(this._timeoutFlag)),this._overlay&&this._map.removeOverlay(this._overlay);var t=new BMap.Marker(this._path[0]);this._opts.icon&&t.setIcon(this._opts.icon),this._map.addOverlay(t),t.setAnimation(BMAP_ANIMATION_DROP),this._marker=t},_addInfoWin:function(){var i=this;!l.prototype.initialize&&u();var t=new l(i._marker.getPosition(),i._opts.defaultContent);t.setRelatedClass(this),this._overlay=t,this._map.addOverlay(t),this._opts.showInfoWindow?this.showInfoWindow():this.hideInfoWindow()},_getMercator:function(i){return this._map.getMapType().getProjection().lngLatToPoint(i)},_getDistance:function(i,t){return Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2))},_move:function(i,t,o){var s=this,h=0,g=10,a=this._opts.speed/(1e3/g),c=this._projection.lngLatToPoint(i),f=this._projection.lngLatToPoint(t),y=Math.round(s._getDistance(c,f)/a);y<1?s._moveNext(++s.i):s._intervalFlag=setInterval(function(){if(h>=y){if(clearInterval(s._intervalFlag),s.i>s._path.length)return;s._moveNext(++s.i),s._opts.onmove(s)}else{h++;var x=o(c.x,f.x,h,y),d=o(c.y,f.y,h,y),w=s._projection.pointToLngLat(new BMap.Pixel(x,d));if(h==1){var B=null;s.i-1>=0&&(B=s._path[s.i-1]),s._opts.enableRotation==1&&s.setRotation(B,i,t),s._opts.autoView&&(s._map.getBounds().containsPoint(w)||s._map.setCenter(w))}s._marker.setPosition(w),s._setInfoWin(w)}},g)},setRotation:function(i,t,o){var s=this,h=0;if(t=s._map.pointToPixel(t),(o=s._map.pointToPixel(o)).x!=t.x){var g=(o.y-t.y)/(o.x-t.x);h=360*Math.atan(g)/(2*Math.PI),h=o.x<t.x?90-h+90:-h,s._marker.setRotation(-h)}else{var a=0;a=o.y-t.y>0?-1:1,s._marker.setRotation(90*-a)}},linePixellength:function(i,t){return Math.sqrt(Math.abs(i.x-t.x)*Math.abs(i.x-t.x)+Math.abs(i.y-t.y)*Math.abs(i.y-t.y))},pointToPoint:function(i,t){return Math.abs(i.x-t.x)*Math.abs(i.x-t.x)+Math.abs(i.y-t.y)*Math.abs(i.y-t.y)},_moveNext:function(i){var t=this;i<this._path.length-1?t._move(t._path[i],t._path[i+1],t._tween.linear):t.stop()},moveNext:function(i){var t=this;i<this._path.length-1?t._move(t._path[i],t._path[i+1],t._tween.linear):t.stop()},_setInfoWin:function(i){var t=this;t._overlay.setPosition(i,t._marker.getIcon().size);var o=t._troughPointIndex(i);o!=-1?(clearInterval(t._intervalFlag),t._overlay.setHtml(t._opts.landmarkPois[o].html),t._overlay.setPosition(i,t._marker.getIcon().size),t._pauseForView(o)):t._overlay.setHtml(t._opts.defaultContent)},_pauseForView:function(i){var t=this,o=setTimeout(function(){t._moveNext(++t.i)},1e3*t._opts.landmarkPois[i].pauseTime);t._setTimeoutQuene.push(o)},_clearTimeout:function(){for(var i in this._setTimeoutQuene)clearTimeout(this._setTimeoutQuene[i]);this._setTimeoutQuene.length=0},_tween:{linear:function(i,t,o,s){return(t-i)*o/s+i}},_troughPointIndex:function(i){for(var t=this._opts.landmarkPois,o=0,s=t.length;o<s;o++)if(!t[o].bShow&&this._map.getDistance(new BMap.Point(t[o].lng,t[o].lat),i)<10)return t[o].bShow=!0,o;return-1}})}(),function(){function e(l,u,i){var t,o,s=l.prototype,h=new Function;for(t in h.prototype=u.prototype,o=l.prototype=new h,s)o[t]=s[t];l.prototype.constructor=l,l.superClass=u.prototype,o._className=i}var n=function(){var l=function(t){var o={data:[],heatmap:t};this.max=1,this.get=function(s){return o[s]},this.set=function(s,h){o[s]=h}};l.prototype={addDataPoint:function(t,o){if(!(t<0||o<0)){var s=this,h=s.get("heatmap"),g=s.get("data");if(g[t]||(g[t]=[]),g[t][o]||(g[t][o]=0),g[t][o]+=arguments.length<3?1:arguments[2],s.set("data",g),s.max<g[t][o])return h.get("actx").clearRect(0,0,h.get("width"),h.get("height")),void s.setDataSet({max:g[t][o],data:g},!0);h.drawAlpha(t,o,g[t][o],!0)}},setDataSet:function(t,o){var s=this.get("heatmap"),h=[],g=t.data,a=g.length;if(s.clear(),this.max=t.max,s.get("legend")&&s.get("legend").update(t.max),o!=null&&o){for(var c in g)if(c!==void 0)for(var f in g[c])f!==void 0&&s.drawAlpha(c,f,g[c][f],!1)}else for(;a--;){var y=g[a];s.drawAlpha(y.x,y.y,y.count,!1),h[y.x]||(h[y.x]=[]),h[y.x][y.y]||(h[y.x][y.y]=0),h[y.x][y.y]=y.count}s.colorize(),this.set("data",g)},exportDataSet:function(){var t=this,o=t.get("data"),s=[];for(var h in o)if(h!==void 0)for(var g in o[h])g!==void 0&&s.push({x:parseInt(h,10),y:parseInt(g,10),count:o[h][g]});return{max:t.max,data:s}},generateRandomDataSet:function(t){var o=this.get("heatmap"),s=o.get("width"),h=o.get("height"),g={},a=Math.floor(1e3*Math.random()+1);g.max=a;for(var c=[];t--;)c.push({x:Math.floor(Math.random()*s+1),y:Math.floor(Math.random()*h+1),count:Math.floor(Math.random()*a+1)});g.data=c,this.setDataSet(g)}};var u=function(t){this.config=t;var o={element:null,labelsEl:null,gradientCfg:null,ctx:null};this.get=function(s){return o[s]},this.set=function(s,h){o[s]=h},this.init()};u.prototype={init:function(){var t=this,o=t.config,s=o.title||"Legend",h=o.position,g=o.offset||10;o.gradient;var a,c,f=document.createElement("ul"),y="";t.processGradientObject(),h.indexOf("t")>-1?y+="top:"+g+"px;":y+="bottom:"+g+"px;",h.indexOf("l")>-1?y+="left:"+g+"px;":y+="right:"+g+"px;",(a=document.createElement("div")).style.cssText="border-radius:5px;position:absolute;"+y+"font-family:Helvetica; width:256px;z-index:10000000000; background:rgba(255,255,255,1);padding:10px;border:1px solid black;margin:0;",a.innerHTML="<h3 style='padding:0;margin:0;text-align:center;font-size:16px;'>"+s+"</h3>",f.style.cssText="position:relative;font-size:12px;display:block;list-style:none;list-style-type:none;margin:0;height:15px;",(c=document.createElement("div")).style.cssText=["position:relative;display:block;width:256px;height:15px;border-bottom:1px solid black; background-image:url(",t.createGradientImage(),");"].join(""),a.appendChild(f),a.appendChild(c),t.set("element",a),t.set("labelsEl",f),t.update(1)},processGradientObject:function(){var t=this,o=this.config.gradient,s=[];for(var h in o)o.hasOwnProperty(h)&&s.push({stop:h,value:o[h]});s.sort(function(g,a){return g.stop-a.stop}),s.unshift({stop:0,value:"rgba(0,0,0,0)"}),t.set("gradientArr",s)},createGradientImage:function(){var t,o=this,s=o.get("gradientArr"),h=s.length,g=document.createElement("canvas"),a=g.getContext("2d");g.width="256",g.height="15",t=a.createLinearGradient(0,5,256,10);for(var c=0;c<h;c++)t.addColorStop(1/(h-1)*c,s[c].value);for(a.fillStyle=t,a.fillRect(0,5,256,10),a.strokeStyle="black",a.beginPath(),c=0;c<h;c++)a.moveTo(.5+(1/(h-1)*c*256|0),0),a.lineTo(.5+(1/(h-1)*c*256|0),c==0?15:5);return a.moveTo(255.5,0),a.lineTo(255.5,15),a.moveTo(255.5,4.5),a.lineTo(0,4.5),a.stroke(),o.set("ctx",a),g.toDataURL()},getElement:function(){return this.get("element")},update:function(t){for(var o,s,h=this,g=h.get("gradientArr"),a=h.get("ctx"),c=h.get("labelsEl"),f="",y=0;y<g.length;y++)o=t*g[y].stop|0,s=a.measureText(o).width/2|0,y==0&&(s=0),y==g.length-1&&(s*=2),f+='<li style="position:absolute;left:'+((0|(1/(g.length-1)*y*256||0))-s+.5)+'px">'+o+"</li>";c.innerHTML=f}};var i=function(t){var o={radius:40,element:{},canvas:{},acanvas:{},ctx:{},actx:{},legend:null,visible:!0,width:0,height:0,max:!1,gradient:!1,opacity:180,premultiplyAlpha:!1,bounds:{l:1e3,r:0,t:1e3,b:0},debug:!1};this.store=new l(this),this.get=function(s){return o[s]},this.set=function(s,h){o[s]=h},this.configure(t),this.init()};return i.prototype={configure:function(t){var o=this;if(o.set("radius",t.radius||40),o.set("element",t.element instanceof Object?t.element:document.getElementById(t.element)),o.set("visible",t.visible==null||t.visible),o.set("max",t.max||!1),o.set("gradient",t.gradient||{.45:"rgb(0,0,255)",.55:"rgb(0,255,255)",.65:"rgb(0,255,0)",.95:"yellow",1:"rgb(255,0,0)"}),o.set("opacity",parseInt(255/(100/t.opacity),10)||180),o.set("width",t.width||0),o.set("height",t.height||0),o.set("debug",t.debug),t.legend){var s=t.legend;s.gradient=o.get("gradient"),o.set("legend",new u(s))}},resize:function(){var t=this,o=t.get("element"),s=t.get("canvas"),h=t.get("acanvas");s.width=h.width=t.get("width")||o.style.width.replace(/px/,"")||t.getWidth(o),this.set("width",s.width),s.height=h.height=t.get("height")||o.style.height.replace(/px/,"")||t.getHeight(o),this.set("height",s.height)},init:function(){var t=this,o=document.createElement("canvas"),s=document.createElement("canvas"),h=o.getContext("2d"),g=s.getContext("2d"),a=t.get("element");t.initColorPalette(),t.set("canvas",o),t.set("ctx",h),t.set("acanvas",s),t.set("actx",g),t.resize(),o.style.cssText=s.style.cssText="position:absolute;top:0;left:0;z-index:10000000;",t.get("visible")||(o.style.display="none"),a.appendChild(o),t.get("legend")&&a.appendChild(t.get("legend").getElement()),t.get("debug")&&document.body.appendChild(s),g.shadowOffsetX=15e3,g.shadowOffsetY=15e3,g.shadowBlur=15},initColorPalette:function(){var t,o,s,h=this,g=document.createElement("canvas"),a=h.get("gradient");for(var c in g.width="1",g.height="256",o=(t=g.getContext("2d")).createLinearGradient(0,0,1,256),(s=t.getImageData(0,0,1,1)).data[0]=s.data[3]=64,s.data[1]=s.data[2]=0,t.putImageData(s,0,0),s=t.getImageData(0,0,1,1),h.set("premultiplyAlpha",s.data[0]<60||s.data[0]>70),a)o.addColorStop(c,a[c]);t.fillStyle=o,t.fillRect(0,0,1,256),h.set("gradient",t.getImageData(0,0,1,256).data)},getWidth:function(t){var o=t.offsetWidth;return t.style.paddingLeft&&(o+=t.style.paddingLeft),t.style.paddingRight&&(o+=t.style.paddingRight),o},getHeight:function(t){var o=t.offsetHeight;return t.style.paddingTop&&(o+=t.style.paddingTop),t.style.paddingBottom&&(o+=t.style.paddingBottom),o},colorize:function(t,o){var s,h,g,a,c,f,y,x,d,w=this,B=w.get("width"),P=w.get("radius"),M=w.get("height"),r=w.get("actx"),m=w.get("ctx"),_=3*P,b=w.get("premultiplyAlpha"),v=w.get("gradient"),S=w.get("opacity"),k=w.get("bounds");t!=null&&o!=null?(t+_>B&&(t=B-_),t<0&&(t=0),o<0&&(o=0),o+_>M&&(o=M-_),s=t,h=o,a=t+_,g=o+_):(s=k.l<0?0:k.l,a=k.r>B?B:k.r,h=k.t<0?0:k.t,g=k.b>M?M:k.b),f=(c=r.getImageData(s,h,a-s,g-h)).data.length;for(var C=3;C<f;C+=4)(x=4*(y=c.data[C]))&&(d=y<S?y:S,c.data[C-3]=v[x],c.data[C-2]=v[x+1],c.data[C-1]=v[x+2],b&&(c.data[C-3]/=255/d,c.data[C-2]/=255/d,c.data[C-1]/=255/d),c.data[C]=d);m.putImageData(c,s,h)},drawAlpha:function(t,o,s,h){var g=this,a=g.get("radius"),c=g.get("actx");g.get("max");var f=g.get("bounds"),y=t-1.5*a|0,x=o-1.5*a|0,d=t+1.5*a|0,w=o+1.5*a|0;c.shadowColor="rgba(0,0,0,"+(s?s/g.store.max:"0.1")+")",c.shadowOffsetX=15e3,c.shadowOffsetY=15e3,c.shadowBlur=15,c.beginPath(),c.arc(t-15e3,o-15e3,a,0,2*Math.PI,!0),c.closePath(),c.fill(),h?g.colorize(y,x):(y<f.l&&(f.l=y),x<f.t&&(f.t=x),d>f.r&&(f.r=d),w>f.b&&(f.b=w))},toggleDisplay:function(){var t=this,o=t.get("visible"),s=t.get("canvas");s.style.display=o?"none":"block",t.set("visible",!o)},getImageData:function(){return this.get("canvas").toDataURL()},clear:function(){var t=this,o=t.get("width"),s=t.get("height");t.store.set("data",[]),t.get("ctx").clearRect(0,0,o,s),t.get("actx").clearRect(0,0,o,s)},cleanup:function(){var t=this;t.get("element").removeChild(t.get("canvas"))}},{create:function(t){return new i(t)},util:{mousePosition:function(t){var o,s;if(t.layerX?(o=t.layerX,s=t.layerY):t.offsetX&&(o=t.offsetX,s=t.offsetY),o!==void 0)return[o,s]}}}}(),p=function(l){try{BMap}catch{throw Error("Baidu Map JS API is not ready yet!")}if(!p._isExtended){p._isExtended=!0,e(p,BMap.Overlay,"HeatmapOverlay");var u=new p(l);this.__proto__=u.__proto__}this.conf=l,this.heatmap=null,this.latlngs=[],this.bounds=null,this._moveendHandler=this._moveendHandler.bind(this)};p.prototype.initialize=function(l){this._map=l;var u=document.createElement("div");return u.style.position="absolute",u.style.top=0,u.style.left=0,u.style.border=0,u.style.width=this._map.getSize().width+"px",u.style.height=this._map.getSize().height+"px",this.conf.element=u,l.getPanes().mapPane.appendChild(u),this.heatmap=n.create(this.conf),this._div=u,u},p.prototype.draw=function(){var l=this._map.getBounds();if(!l.equals(this.bounds)){this.bounds=l;var u=this._map.pointToOverlayPixel(l.getNorthEast()),i=this._map.pointToOverlayPixel(l.getSouthWest());if(u&&i){var t=u.y,o=i.x,s=i.y-u.y,h=u.x-i.x;if(this.conf.element.style.left=o+"px",this.conf.element.style.top=t+"px",this.conf.element.style.width=h+"px",this.conf.element.style.height=s+"px",this.heatmap.store.get("heatmap").resize(),this.latlngs.length>0){this.heatmap.clear();for(var g=this.latlngs.length,a={max:this.heatmap.store.max,data:[]};g--;){var c=this.latlngs[g].latlng;if(l.containsPoint(c)){var f=this._map.pointToOverlayPixel(c),y=new BMap.Pixel(f.x-o,f.y-t),x=this.pixelTransform(y);a.data.push({x:x.x,y:x.y,count:this.latlngs[g].c})}}this.heatmap.store.setDataSet(a)}}}},p.prototype.pixelTransform=function(l){for(var u=this.heatmap.get("width"),i=this.heatmap.get("height");l.x<0;)l.x+=u;for(;l.x>u;)l.x-=u;for(;l.y<0;)l.y+=i;for(;l.y>i;)l.y-=i;return l.x=0|l.x,l.y=0|l.y,l},p.prototype._moveendHandler=function(l){this.setDataSet(this._data),delete this._data,this._map.removeEventListener("moveend",this._moveendHandler)},p.prototype.setDataSet=function(l){if(this._map){var u=this._map.getBounds(),i=this._map.pointToOverlayPixel(u.getNorthEast()),t=this._map.pointToOverlayPixel(u.getSouthWest());i&&t||(this._data=l,this._map.addEventListener("moveend",this._moveendHandler));var o={max:l.max,data:[]},s=l.data,h=s.length;for(this.latlngs=[];h--;){var g=new BMap.Point(s[h].lng,s[h].lat);if(this.latlngs.push({latlng:g,c:s[h].count}),u.containsPoint(g)){var a=this._map.pointToOverlayPixel(g),c=this._map.pointToOverlayPixel(u.getSouthWest()).x,f=this._map.pointToOverlayPixel(u.getNorthEast()).y,y=new BMap.Pixel(a.x-c,a.y-f),x=this.pixelTransform(y);o.data.push({x:x.x,y:x.y,count:s[h].count})}}this.heatmap.clear(),this.heatmap.store.setDataSet(o)}},p.prototype.addDataPoint=function(l,u,i){var t=new BMap.Point(l,u),o=this.pixelTransform(this._map.pointToOverlayPixel(t));this.heatmap.store.addDataPoint(o.x,o.y,i),this.latlngs.push({latlng:t,c:i})},p.prototype.toggle=function(){this.heatmap.toggleDisplay()}}(),st=Zt(Tt({__name:"map",emits:["mapConfirm"],setup(e,{expose:n,emit:p}){const l=Dt(),u=L("m1YRfvvQt9dPVNuPSieTED33hZkIznSn"),i=L(15),t=L({}),o=L({lng:116.404,lat:39.915}),s=L({point:{},address:"",province:"",city:"",district:"",addr:""}),h=L(!1),g=L("\u5730\u56FE\u9009\u62E9"),a=L("");n({open:async()=>{h.value=!0}});const c=d=>{t.value=d.BMap,t.value&&new t.value.Geolocation().getCurrentPosition(w=>{if(w){const{lng:B,lat:P}=w.point,{province:M,city:r,district:m,street:_,street_number:b}=w.address;o.value={lng:B,lat:P},s.value={province:M,city:r,district:m,addr:_+b,lng:B,lat:P}}})},f=d=>{o.value.lng=d.point.lng,o.value.lat=d.point.lat,t.value&&new t.value.Geocoder().getLocation(d.point,function(w){const B=w.addressComponents,P=w.surroundingPois,M=B.province,r=B.city,m=B.district,_=d.point,b=w.address;let v=B.street;P.length>0&&P[0].title?v+=v?`-${P[0].title}`:`${P[0].title}`:v+=B.streetNumber,s.value={point:_,address:b,province:M,city:r,district:m,addr:v,...o.value}})},y=d=>{i.value=d.target.getZoom()},x=()=>{if(s.value.address=="")return l.error("\u8BF7\u9009\u62E9\u5B9A\u4F4D\u5730\u5740");h.value=!1,p("mapConfirm",s.value)};return(d,w)=>{const B=Ot("bm-view"),P=At,M=Lt,r=xt;return D(),Et(r,{title:I(g),modelValue:I(h),"onUpdate:modelValue":w[3]||(w[3]=m=>tt(h)?h.value=m:null)},{footer:R(()=>[O(M,{onClick:w[2]||(w[2]=m=>h.value=!1)},{default:R(()=>[at("\u53D6 \u6D88")]),_:1}),O(M,{icon:"el-icon-place",type:"primary",onClick:x},{default:R(()=>[at("\u786E \u5B9A")]),_:1})]),default:R(()=>[O(I(ct),{style:{height:"400px",width:"100%"},ak:I(u),"map-click":!1,center:I(o),zoom:I(i),"scroll-wheel-zoom":!0,onClick:f,onMoving:y,onMoveend:y,onReady:c,onZoomend:y},{default:R(()=>[O(B,{style:{width:"100%",height:"100%"}}),O(I(yt),{position:{lng:I(o).lng,lat:I(o).lat},dragging:!0,animation:"BMAP_ANIMATION_BOUNCE"},null,8,["position"]),O(I(ft),{offset:{width:"10px",height:"10px"}},{default:R(()=>[O(I(wt),{modelValue:I(a),"onUpdate:modelValue":w[1]||(w[1]=m=>tt(a)?a.value=m:null),"sug-style":{zIndex:999999}},{default:R(()=>[O(P,{modelValue:I(a),"onUpdate:modelValue":w[0]||(w[0]=m=>tt(a)?a.value=m:null),type:"text",placeholder:"\u8BF7\u8F93\u5165\u5730\u540D\u5173\u952E\u5B57",clearable:""},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),O(I(gt),{anchor:"BMAP_ANCHOR_BOTTOM_RIGHT","show-address-bar":"","auto-location":""}),O(I(_t),{keyword:I(a),"auto-viewport":!0,panel:!1},null,8,["keyword"])]),_:1},8,["ak","center","zoom"])]),_:1},8,["title","modelValue"])}}}),[["__scopeId","data-v-a6bf808d"]])});export{Ft as __tla,st as default};
