import{aQ as V,d as K,r as e,S as sa,o as d,c as U,g as c,w as y,a as _,G as k,f as v,t as oa,A as W,H as X,h as Y,F as pa,J as ma,M as da,L as ya,P as va,y as ha,z as fa,__tla as Ma}from"./index-DkWBYEPi.js";import{_ as xa,__tla as Ua}from"./ContentWrap.vue_vue_type_script_name_ContentWrap_setup_true_lang-D1HvrCoL.js";import{_ as ga,__tla as Ia}from"./index-BKpCHil1.js";import{_ as ba,__tla as wa}from"./main.vue_vue_type_script_setup_true_name_WxAccountSelect_lang-VAzfW7vs.js";import Ca,{__tla as Ta}from"./MenuEditor-Cidlgcuz.js";import Ea,{__tla as Va}from"./MenuPreviewer-BF_zUxP9.js";import{h as ka}from"./tree-CxUbcu7T.js";import{u as Sa,__tla as qa}from"./useMessage-CeuPBduw.js";import{_ as Da}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{__tla as Ha}from"./el-card-C7CWu32a.js";import{__tla as Pa}from"./index-HWFhyYT3.js";import{__tla as Aa}from"./main-DqT5DnNY.js";import{__tla as Na}from"./TabNews-BhmPjQvA.js";import{__tla as $a}from"./main-gHn_YEeU.js";import{__tla as Fa}from"./el-image-CKhc-ZHp.js";import{__tla as La}from"./el-image-viewer-Dai4IHUY.js";import{__tla as Oa}from"./main-CSvi-KCF.js";import{__tla as Qa}from"./index-C0_EgrOD.js";import{__tla as za}from"./main-DfaZZ1_T.js";import{__tla as Ga}from"./main.vue_vue_type_script_setup_true_name_WxVideoPlayer_lang-DcBtaqev.js";import{__tla as Ja}from"./index-CJ06tICG.js";import{__tla as Ra}from"./index-B8ycpn88.js";import{__tla as ja}from"./formatTime-PkYKTZNp.js";import{__tla as Ba}from"./TabText.vue_vue_type_script_setup_true_lang-oQwLg9dc.js";import{__tla as Ka}from"./TabImage-DFF6y9O8.js";import{__tla as Wa}from"./useUpload-D3Wgu7Q5.js";import{__tla as Xa}from"./TabVoice-C9c1Hr-p.js";import{__tla as Ya}from"./TabVideo-CTKy7wVr.js";import{__tla as Za}from"./TabMusic.vue_vue_type_script_setup_true_lang-qfp6fbDQ.js";let Z,at=Promise.all([(()=>{try{return Ma}catch{}})(),(()=>{try{return Ua}catch{}})(),(()=>{try{return Ia}catch{}})(),(()=>{try{return wa}catch{}})(),(()=>{try{return Ta}catch{}})(),(()=>{try{return Va}catch{}})(),(()=>{try{return qa}catch{}})(),(()=>{try{return Ha}catch{}})(),(()=>{try{return Pa}catch{}})(),(()=>{try{return Aa}catch{}})(),(()=>{try{return Na}catch{}})(),(()=>{try{return $a}catch{}})(),(()=>{try{return Fa}catch{}})(),(()=>{try{return La}catch{}})(),(()=>{try{return Oa}catch{}})(),(()=>{try{return Qa}catch{}})(),(()=>{try{return za}catch{}})(),(()=>{try{return Ga}catch{}})(),(()=>{try{return Ja}catch{}})(),(()=>{try{return Ra}catch{}})(),(()=>{try{return ja}catch{}})(),(()=>{try{return Ba}catch{}})(),(()=>{try{return Ka}catch{}})(),(()=>{try{return Wa}catch{}})(),(()=>{try{return Xa}catch{}})(),(()=>{try{return Ya}catch{}})(),(()=>{try{return Za}catch{}})()]).then(async()=>{let S,q,D,H,P,A,N,$,F,L;S={class:"public-account-management clearfix"},q={class:"left"},D={class:"weixin-hd"},H={class:"weixin-title"},P={class:"weixin-menu clearfix"},A={class:"save_div"},N={key:0,class:"right"},$={key:1,class:"right"},F=[(x=>(ha("data-v-da665a3f"),x=x(),fa(),x))(()=>v("p",null,"\u8BF7\u9009\u62E9\u83DC\u5355\u914D\u7F6E",-1))],L=K({name:"MpMenu"}),Z=Da(K({...L,setup(x){const o=Sa(),g="__MENU_NOT_SELECTED__",u=e(!1),p=e(0),O=e(""),i=e([]),h=e(g),I=e(-1),f=e(!1),b=e(!0),n=e({});let Q;var w;(w=Q||(Q={})).Undefined="0",w.Parent="1",w.Child="2";const r=e({grand:"0",x:0,y:0}),aa=e(!1),ta=(t,a)=>{p.value=t,O.value=a,C()},C=async()=>{u.value=!1;try{const t=await(l=>V.get({url:"/mp/menu/list?accountId="+l}))(p.value),a=la(t);i.value=ka(a,"id")}finally{u.value=!1}},la=t=>{if(!t)return[];const a=[];return t.forEach(l=>{const m={...l};m.reply={type:l.replyMessageType,accountId:l.accountId,content:l.replyContent,mediaId:l.replyMediaId,url:l.replyMediaUrl,title:l.replyTitle,description:l.replyDescription,thumbMediaId:l.replyThumbMediaId,thumbMediaUrl:l.replyThumbMediaUrl,articles:l.replyArticles,musicUrl:l.replyMusicUrl,hqMusicUrl:l.replyHqMusicUrl},a.push(m)}),a},ra=()=>{h.value=g,I.value=-1,f.value=!1,n.value={},r.value={grand:"0",x:0,y:0},aa.value=!1},ea=async()=>{var t;try{await o.confirm("\u786E\u5B9A\u8981\u5220\u9664\u5417?"),r.value.grand==="1"?i.value.splice(r.value.x,1):r.value.grand==="2"&&((t=i.value[r.value.x].children)==null||t.splice(r.value.y,1)),o.notifySuccess("\u5220\u9664\u6210\u529F"),n.value={},f.value=!1,h.value=g}catch{}},_a=async()=>{try{await o.confirm("\u786E\u5B9A\u8981\u4FDD\u5B58\u5417?"),u.value=!0,await((t,a)=>V.post({url:"/mp/menu/save",data:{accountId:t,menus:a}}))(p.value,ua()),C(),o.notifySuccess("\u53D1\u5E03\u6210\u529F")}finally{u.value=!1}},ca=async()=>{try{await o.confirm("\u786E\u5B9A\u8981\u5220\u9664\u5417?"),u.value=!0,await(t=>V.delete({url:"/mp/menu/delete?accountId="+t}))(p.value),ra(),C(),o.notifySuccess("\u6E05\u7A7A\u6210\u529F")}finally{u.value=!1}},ua=()=>{const t=[];return i.value.forEach(a=>{const l=z(a);t.push(l),!a.children||a.children.length<=0||(l.children=[],a.children.forEach(m=>{l.children.push(z(m))}))}),t},z=t=>{let a={...t,children:void 0,reply:void 0};return a.replyMessageType=t.reply.type,a.replyContent=t.reply.content,a.replyMediaId=t.reply.mediaId,a.replyMediaUrl=t.reply.url,a.replyTitle=t.reply.title,a.replyDescription=t.reply.description,a.replyThumbMediaId=t.reply.thumbMediaId,a.replyThumbMediaUrl=t.reply.thumbMediaUrl,a.replyArticles=t.reply.articles,a.replyMusicUrl=t.reply.musicUrl,a.replyHqMusicUrl=t.reply.hqMusicUrl,a};return(t,a)=>{const l=ga,m=ma,ia=da,G=xa,J=ya,R=sa("hasPermi"),na=va;return d(),U(pa,null,[c(l,{title:"\u516C\u4F17\u53F7\u83DC\u5355",url:"https://www.yixiang.co/mp/menu/"}),c(G,null,{default:y(()=>[c(ia,{class:"-mb-15px",ref:"queryFormRef",inline:!0,"label-width":"68px"},{default:y(()=>[c(m,{label:"\u516C\u4F17\u53F7",prop:"accountId"},{default:y(()=>[c(_(ba),{onChange:ta})]),_:1})]),_:1},512)]),_:1}),c(G,null,{default:y(()=>[k((d(),U("div",S,[v("div",q,[v("div",D,[v("div",H,oa(_(O)),1)]),v("div",P,[c(Ea,{modelValue:_(i),"onUpdate:modelValue":a[0]||(a[0]=s=>W(i)?i.value=s:null),"account-id":_(p),"active-index":_(h),"parent-index":_(I),onMenuClicked:a[1]||(a[1]=(s,T)=>((E,M)=>{f.value=!0,n.value=E,r.value.grand="1",r.value.x=M,b.value=!0,h.value=`${M}`,I.value=M})(s,T)),onSubmenuClicked:a[2]||(a[2]=(s,T,E)=>((M,j,B)=>{f.value=!0,n.value=M,r.value.grand="2",r.value.x=j,r.value.y=B,b.value=!1,h.value=`${j}-${B}`})(s,T,E))},null,8,["modelValue","account-id","active-index","parent-index"])]),v("div",A,[k((d(),X(J,{class:"save_btn",type:"success",onClick:_a},{default:y(()=>[Y("\u4FDD\u5B58\u5E76\u53D1\u5E03\u83DC\u5355")]),_:1})),[[R,["mp:menu:save"]]]),k((d(),X(J,{class:"save_btn",type:"danger",onClick:ca},{default:y(()=>[Y("\u6E05\u7A7A\u83DC\u5355")]),_:1})),[[R,["mp:menu:delete"]]])])]),_(f)?(d(),U("div",N,[c(Ca,{"account-id":_(p),"is-parent":_(b),modelValue:_(n),"onUpdate:modelValue":a[3]||(a[3]=s=>W(n)?n.value=s:null),onDelete:ea},null,8,["account-id","is-parent","modelValue"])])):(d(),U("div",$,F))])),[[na,_(u)]])]),_:1})],64)}}}),[["__scopeId","data-v-da665a3f"]])});export{at as __tla,Z as default};
