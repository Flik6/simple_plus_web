import{bs as Rt,d as X,a1 as K,ac as J,r as Q,an as tt,o as et,c as st,g as nt,w as Yt,aj as Vt,a as M,A as Ft,n as W,f as Bt,i as Ht,l as Ut,X as Zt,_ as Xt,__tla as Kt}from"./index-BFAKpZuq.js";import{_ as Jt}from"./_plugin-vue_export-helper-BCo6x5W8.js";let rt,Qt=Promise.all([(()=>{try{return Kt}catch{}})()]).then(async()=>{const L=(r,t)=>r.push.apply(r,t),at=(r,t)=>r.split("").map(e=>t[e]||e).join(""),A=r=>r.sort((t,e)=>t.i-e.i||t.j-e.j),z=r=>{const t={};let e=1;return r.forEach(s=>{t[s]=e,e+=1}),t},ot={4:[[1,2],[2,3]],5:[[1,3],[2,3],[2,4]],6:[[1,2],[2,4],[4,5]],7:[[1,3],[2,3],[4,5],[4,6]],8:[[2,4],[4,6]]},$=/^[A-Z\xbf-\xdf][^A-Z\xbf-\xdf]+$/,it=/^[^A-Z\xbf-\xdf]+[A-Z\xbf-\xdf]$/,ct=/^[A-Z\xbf-\xdf]+$/,G=/^[^a-z\xdf-\xff]+$/,lt=/^[a-z\xdf-\xff]+$/,ht=/^[^A-Z\xbf-\xdf]+$/,ut=/[a-z\xdf-\xff]/,dt=/[A-Z\xbf-\xdf]/,gt=/[^A-Za-z\xbf-\xdf]/gi,pt=/^\d+$/,O=new Date().getFullYear(),ft={recentYear:/19\d\d|200\d|201\d|202\d/g};class mt{match({password:t}){const e=[...this.getMatchesWithoutSeparator(t),...this.getMatchesWithSeparator(t)],s=this.filterNoise(e);return A(s)}getMatchesWithSeparator(t){const e=[],s=/^(\d{1,4})([\s/\\_.-])(\d{1,2})\2(\d{1,4})$/;for(let n=0;n<=Math.abs(t.length-6);n+=1)for(let a=n+5;a<=n+9&&!(a>=t.length);a+=1){const o=t.slice(n,+a+1||9e9),i=s.exec(o);if(i!=null){const c=this.mapIntegersToDayMonthYear([parseInt(i[1],10),parseInt(i[3],10),parseInt(i[4],10)]);c!=null&&e.push({pattern:"date",token:o,i:n,j:a,separator:i[2],year:c.year,month:c.month,day:c.day})}}return e}getMatchesWithoutSeparator(t){const e=[],s=/^\d{4,8}$/,n=a=>Math.abs(a.year-O);for(let a=0;a<=Math.abs(t.length-4);a+=1)for(let o=a+3;o<=a+7&&!(o>=t.length);o+=1){const i=t.slice(a,+o+1||9e9);if(s.exec(i)){const c=[],l=i.length;if(ot[l].forEach(([u,h])=>{const p=this.mapIntegersToDayMonthYear([parseInt(i.slice(0,u),10),parseInt(i.slice(u,h),10),parseInt(i.slice(h),10)]);p!=null&&c.push(p)}),c.length>0){let u=c[0],h=n(c[0]);c.slice(1).forEach(p=>{const f=n(p);f<h&&(u=p,h=f)}),e.push({pattern:"date",token:i,i:a,j:o,separator:"",year:u.year,month:u.month,day:u.day})}}}return e}filterNoise(t){return t.filter(e=>{let s=!1;const n=t.length;for(let a=0;a<n;a+=1){const o=t[a];if(e!==o&&o.i<=e.i&&o.j>=e.j){s=!0;break}}return!s})}mapIntegersToDayMonthYear(t){if(t[1]>31||t[1]<=0)return null;let e=0,s=0,n=0;for(let a=0,o=t.length;a<o;a+=1){const i=t[a];if(i>99&&i<1e3||i>2050)return null;i>31&&(s+=1),i>12&&(e+=1),i<=0&&(n+=1)}return s>=2||e===3||n>=2?null:this.getDayMonth(t)}getDayMonth(t){const e=[[t[2],t.slice(0,2)],[t[0],t.slice(1,3)]],s=e.length;for(let n=0;n<s;n+=1){const[a,o]=e[n];if(1e3<=a&&a<=2050){const i=this.mapIntegersToDayMonth(o);return i!=null?{year:a,month:i.month,day:i.day}:null}}for(let n=0;n<s;n+=1){const[a,o]=e[n],i=this.mapIntegersToDayMonth(o);if(i!=null)return{year:this.twoToFourDigitYear(a),month:i.month,day:i.day}}return null}mapIntegersToDayMonth(t){const e=[t,t.slice().reverse()];for(let s=0;s<e.length;s+=1){const n=e[s],a=n[0],o=n[1];if(a>=1&&a<=31&&o>=1&&o<=12)return{day:a,month:o}}return null}twoToFourDigitYear(t){return t>99?t:t>50?t+1900:t+2e3}}const S=new Uint32Array(65536),bt=(r,t)=>{if(r.length<t.length){const e=t;t=r,r=e}return t.length===0?r.length:r.length<=32?((e,s)=>{const n=e.length,a=s.length,o=1<<n-1;let i=-1,c=0,l=n,u=n;for(;u--;)S[e.charCodeAt(u)]|=1<<u;for(u=0;u<a;u++){let h=S[s.charCodeAt(u)];const p=h|c;h|=(h&i)+i^i,c|=~(h|i),i&=h,c&o&&l++,i&o&&l--,c=c<<1|1,i=i<<1|~(p|c),c&=p}for(u=n;u--;)S[e.charCodeAt(u)]=0;return l})(r,t):((e,s)=>{const n=s.length,a=e.length,o=[],i=[],c=Math.ceil(n/32),l=Math.ceil(a/32);for(let g=0;g<c;g++)i[g]=-1,o[g]=0;let u=0;for(;u<l-1;u++){let g=0,b=-1;const k=32*u,v=Math.min(32,a)+k;for(let m=k;m<v;m++)S[e.charCodeAt(m)]|=1<<m;for(let m=0;m<n;m++){const T=S[s.charCodeAt(m)],I=i[m/32|0]>>>m&1,j=o[m/32|0]>>>m&1,U=T|g,Z=((T|j)&b)+b^b|T|j;let E=g|~(Z|b),C=b&Z;E>>>31^I&&(i[m/32|0]^=1<<m),C>>>31^j&&(o[m/32|0]^=1<<m),E=E<<1|I,C=C<<1|j,b=C|~(U|E),g=E&U}for(let m=k;m<v;m++)S[e.charCodeAt(m)]=0}let h=0,p=-1;const f=32*u,y=Math.min(32,a-f)+f;for(let g=f;g<y;g++)S[e.charCodeAt(g)]|=1<<g;let w=a;for(let g=0;g<n;g++){const b=S[s.charCodeAt(g)],k=i[g/32|0]>>>g&1,v=o[g/32|0]>>>g&1,m=b|h,T=((b|v)&p)+p^p|b|v;let I=h|~(T|p),j=p&T;w+=I>>>a-1&1,w-=j>>>a-1&1,I>>>31^k&&(i[g/32|0]^=1<<g),j>>>31^v&&(o[g/32|0]^=1<<g),I=I<<1|k,j=j<<1|v,p=j|~(m|I),h=I&m}for(let g=f;g<y;g++)S[e.charCodeAt(g)]=0;return w})(r,t)},yt=(r,t,e)=>{let s=0;const n=Object.keys(t).find(a=>{const o=((l,u,h)=>{const p=l.length<=u.length,f=l.length<=h;return p||f?Math.ceil(l.length/4):h})(r,a,e),i=bt(r,a),c=i<=o;return c&&(s=i),c});return n?{levenshteinDistance:s,levenshteinDistanceEntry:n}:{}};var kt={a:["4","@"],b:["8"],c:["(","{","[","<"],e:["3"],g:["6","9"],i:["1","!","|"],l:["1","|","7"],o:["0"],s:["$","5"],t:["+","7"],x:["%"],z:["2"]},P={warnings:{straightRow:"straightRow",keyPattern:"keyPattern",simpleRepeat:"simpleRepeat",extendedRepeat:"extendedRepeat",sequences:"sequences",recentYears:"recentYears",dates:"dates",topTen:"topTen",topHundred:"topHundred",common:"common",similarToCommon:"similarToCommon",wordByItself:"wordByItself",namesByThemselves:"namesByThemselves",commonNames:"commonNames",userInputs:"userInputs",pwned:"pwned"},suggestions:{l33t:"l33t",reverseWords:"reverseWords",allUppercase:"allUppercase",capitalization:"capitalization",dates:"dates",recentYears:"recentYears",associatedYears:"associatedYears",sequences:"sequences",repeated:"repeated",longerKeyboardPattern:"longerKeyboardPattern",anotherWord:"anotherWord",useWords:"useWords",noNeed:"noNeed",pwned:"pwned"},timeEstimation:{ltSecond:"ltSecond",second:"second",seconds:"seconds",minute:"minute",minutes:"minutes",hour:"hour",hours:"hours",day:"day",days:"days",month:"month",months:"months",year:"year",years:"years",centuries:"centuries"}};const d=new class{constructor(){this.matchers={},this.l33tTable=kt,this.dictionary={userInputs:[]},this.rankedDictionaries={},this.rankedDictionariesMaxWordSize={},this.translations=P,this.graphs={},this.useLevenshteinDistance=!1,this.levenshteinThreshold=2,this.l33tMaxSubstitutions=100,this.maxLength=256,this.setRankedDictionaries()}setOptions(r={}){r.l33tTable&&(this.l33tTable=r.l33tTable),r.dictionary&&(this.dictionary=r.dictionary,this.setRankedDictionaries()),r.translations&&this.setTranslations(r.translations),r.graphs&&(this.graphs=r.graphs),r.useLevenshteinDistance!==void 0&&(this.useLevenshteinDistance=r.useLevenshteinDistance),r.levenshteinThreshold!==void 0&&(this.levenshteinThreshold=r.levenshteinThreshold),r.l33tMaxSubstitutions!==void 0&&(this.l33tMaxSubstitutions=r.l33tMaxSubstitutions),r.maxLength!==void 0&&(this.maxLength=r.maxLength)}setTranslations(r){if(!this.checkCustomTranslations(r))throw new Error("Invalid translations object fallback to keys");this.translations=r}checkCustomTranslations(r){let t=!0;return Object.keys(P).forEach(e=>{if(e in r){const s=e;Object.keys(P[s]).forEach(n=>{n in r[s]||(t=!1)})}else t=!1}),t}setRankedDictionaries(){const r={},t={};Object.keys(this.dictionary).forEach(e=>{r[e]=this.getRankedDictionary(e),t[e]=this.getRankedDictionariesMaxWordSize(e)}),this.rankedDictionaries=r,this.rankedDictionariesMaxWordSize=t}getRankedDictionariesMaxWordSize(r){const t=this.dictionary[r].map(e=>typeof e!="string"?e.toString().length:e.length);return t.length===0?0:t.reduce((e,s)=>Math.max(e,s),-1/0)}getRankedDictionary(r){const t=this.dictionary[r];if(r==="userInputs"){const e=[];return t.forEach(s=>{const n=typeof s;n!=="string"&&n!=="number"&&n!=="boolean"||e.push(s.toString().toLowerCase())}),z(e)}return z(t)}extendUserInputsDictionary(r){this.dictionary.userInputs?this.dictionary.userInputs=[...this.dictionary.userInputs,...r]:this.dictionary.userInputs=r,this.rankedDictionaries.userInputs=this.getRankedDictionary("userInputs"),this.rankedDictionariesMaxWordSize.userInputs=this.getRankedDictionariesMaxWordSize("userInputs")}addMatcher(r,t){this.matchers[r]||(this.matchers[r]=t)}};class wt{constructor(t){this.defaultMatch=t}match({password:t}){const e=t.split("").reverse().join("");return this.defaultMatch({password:e}).map(s=>({...s,token:s.token.split("").reverse().join(""),reversed:!0,i:t.length-1-s.j,j:t.length-1-s.i}))}}class Mt{constructor(t){this.defaultMatch=t}match({password:t}){const e=[],s=this.enumerateL33tSubs(this.relevantL33tSubtable(t,d.l33tTable)),n=Math.min(s.length,d.l33tMaxSubstitutions);for(let o=0;o<n;o+=1){const i=s[o];if(a=i,Object.keys(a).length===0)break;const c=at(t,i);this.defaultMatch({password:c}).forEach(l=>{const u=t.slice(l.i,+l.j+1||9e9);if(u.toLowerCase()!==l.matchedWord){const h={};Object.keys(i).forEach(f=>{const y=i[f];u.indexOf(f)!==-1&&(h[f]=y)});const p=Object.keys(h).map(f=>`${f} -> ${h[f]}`).join(", ");e.push({...l,l33t:!0,token:u,sub:h,subDisplay:p})}})}var a;return e.filter(o=>o.token.length>1)}relevantL33tSubtable(t,e){const s={},n={};return t.split("").forEach(a=>{s[a]=!0}),Object.keys(e).forEach(a=>{const o=e[a].filter(i=>i in s);o.length>0&&(n[a]=o)}),n}enumerateL33tSubs(t){const e=Object.keys(t);return this.getSubs(e,[[]],t).map(s=>{const n={};return s.forEach(([a,o])=>{n[a]=o}),n})}getSubs(t,e,s){if(!t.length)return e;const n=t[0],a=t.slice(1),o=[];s[n].forEach(c=>{e.forEach(l=>{let u=-1;for(let h=0;h<l.length;h+=1)if(l[h][0]===c){u=h;break}if(u===-1){const h=l.concat([[c,n]]);o.push(h)}else{const h=l.slice(0);h.splice(u,1),h.push([c,n]),o.push(l),o.push(h)}})});const i=this.dedup(o);return a.length?this.getSubs(a,i,s):i}dedup(t){const e=[],s={};return t.forEach(n=>{const a=n.map((i,c)=>[i,c]);a.sort();const o=a.map(([i,c])=>`${i},${c}`).join("-");o in s||(s[o]=!0,e.push(n))}),e}}class xt{constructor(){this.l33t=new Mt(this.defaultMatch),this.reverse=new wt(this.defaultMatch)}match({password:t}){const e=[...this.defaultMatch({password:t}),...this.reverse.match({password:t}),...this.l33t.match({password:t})];return A(e)}defaultMatch({password:t}){const e=[],s=t.length,n=t.toLowerCase();return Object.keys(d.rankedDictionaries).forEach(a=>{const o=d.rankedDictionaries[a],i=d.rankedDictionariesMaxWordSize[a],c=Math.min(i,s);for(let l=0;l<s;l+=1){const u=Math.min(l+c,s);for(let h=l;h<u;h+=1){const p=n.slice(l,+h+1||9e9),f=p in o;let y={};const w=l===0&&h===s-1;d.useLevenshteinDistance&&w&&!f&&(y=yt(p,o,d.levenshteinThreshold));const g=Object.keys(y).length!==0;if(f||g){const b=o[g?y.levenshteinDistanceEntry:p];e.push({pattern:"dictionary",i:l,j:h,token:t.slice(l,+h+1||9e9),matchedWord:p,rank:b,dictionaryName:a,reversed:!1,l33t:!1,...y})}}}}),e}}class vt{match({password:t,regexes:e=ft}){const s=[];return Object.keys(e).forEach(n=>{const a=e[n];a.lastIndex=0;const o=a.exec(t);if(o){const i=o[0];s.push({pattern:"regex",token:i,i:o.index,j:o.index+o[0].length-1,regexName:n,regexMatch:o})}}),A(s)}}var D={nCk(r,t){let e=r;if(t>e)return 0;if(t===0)return 1;let s=1;for(let n=1;n<=t;n+=1)s*=e,s/=n,e-=1;return s},log10:r=>Math.log(r)/Math.log(10),log2:r=>Math.log(r)/Math.log(2),factorial(r){let t=1;for(let e=2;e<=r;e+=1)t*=e;return t}},Tt=r=>{const t=r.replace(gt,"");if(t.match(ht)||t.toLowerCase()===t)return 1;const e=[$,it,G],s=e.length;for(let n=0;n<s;n+=1){const a=e[n];if(t.match(a))return 2}return(n=>{const a=n.split(""),o=a.filter(u=>u.match(dt)).length,i=a.filter(u=>u.match(ut)).length;let c=0;const l=Math.min(o,i);for(let u=1;u<=l;u+=1)c+=D.nCk(o+i,u);return c})(t)};const jt=({token:r,graph:t,turns:e})=>{const s=Object.keys(d.graphs[t]).length,n=(i=>{let c=0;return Object.keys(i).forEach(l=>{const u=i[l];c+=u.filter(h=>!!h).length}),c/=Object.entries(i).length,c})(d.graphs[t]);let a=0;const o=r.length;for(let i=2;i<=o;i+=1){const c=Math.min(e,i-1);for(let l=1;l<=c;l+=1)a+=D.nCk(i-1,l-1)*s*n**l}return a},R={bruteforce:({token:r})=>{let t,e=10**r.length;return e===Number.POSITIVE_INFINITY&&(e=Number.MAX_VALUE),t=r.length===1?11:51,Math.max(e,t)},date:({year:r,separator:t})=>{let e=365*Math.max(Math.abs(r-O),20);return t&&(e*=4),e},dictionary:({rank:r,reversed:t,l33t:e,sub:s,token:n})=>{const a=r,o=Tt(n),i=(({l33t:c,sub:l,token:u})=>{if(!c)return 1;let h=1;const p=l;return Object.keys(p).forEach(f=>{const{subbedCount:y,unsubbedCount:w}=(({subs:g,subbed:b,token:k})=>{const v=g[b],m=k.toLowerCase().split("");return{subbedCount:m.filter(T=>T===b).length,unsubbedCount:m.filter(T=>T===v).length}})({subs:p,subbed:f,token:u});if(y===0||w===0)h*=2;else{const g=Math.min(w,y);let b=0;for(let k=1;k<=g;k+=1)b+=D.nCk(w+y,k);h*=b}}),h})({l33t:e,sub:s,token:n});return{baseGuesses:a,uppercaseVariations:o,l33tVariations:i,calculation:a*o*i*(t?2:1)}},regex:({regexName:r,regexMatch:t,token:e})=>{const s={alphaLower:26,alphaUpper:26,alpha:52,alphanumeric:62,digits:10,symbols:33};return r in s?s[r]**e.length:r==="recentYear"?Math.max(Math.abs(parseInt(t[0],10)-O),20):0},repeat:({baseGuesses:r,repeatCount:t})=>r*t,sequence:({token:r,ascending:t})=>{const e=r.charAt(0);let s=0;return s=["a","A","z","Z","0","1","9"].includes(e)?4:e.match(/\d/)?10:26,t||(s*=2),s*r.length},spatial:({graph:r,token:t,shiftedCount:e,turns:s})=>{let n=jt({token:t,graph:r,turns:s});if(e){const a=t.length-e;if(e===0||a===0)n*=2;else{let o=0;for(let i=1;i<=Math.min(e,a);i+=1)o+=D.nCk(e+a,i);n*=o}}return Math.round(n)}};var St=(r,t)=>{const e={};if("guesses"in r&&r.guesses!=null)return r;const s=((i,c)=>{let l=1;return i.token.length<c.length&&(l=i.token.length===1?10:50),l})(r,t),n=((i,c)=>R[i]?R[i](c):d.matchers[i]&&"scoring"in d.matchers[i]?d.matchers[i].scoring(c):0)(r.pattern,r);let a=0;typeof n=="number"?a=n:r.pattern==="dictionary"&&(a=n.calculation,e.baseGuesses=n.baseGuesses,e.uppercaseVariations=n.uppercaseVariations,e.l33tVariations=n.l33tVariations);const o=Math.max(a,s);return{...r,...e,guesses:o,guessesLog10:D.log10(o)}};const x={password:"",optimal:{},excludeAdditive:!1,fillArray(r,t){const e=[];for(let s=0;s<r;s+=1){let n=[];t==="object"&&(n={}),e.push(n)}return e},makeBruteforceMatch(r,t){return{pattern:"bruteforce",token:this.password.slice(r,+t+1||9e9),i:r,j:t}},update(r,t){const e=r.j,s=St(r,this.password);let n=s.guesses;t>1&&(n*=this.optimal.pi[s.i-1][t-1]);let a=D.factorial(t)*n;this.excludeAdditive||(a+=1e4**(t-1));let o=!1;Object.keys(this.optimal.g[e]).forEach(i=>{const c=this.optimal.g[e][i];parseInt(i,10)<=t&&c<=a&&(o=!0)}),o||(this.optimal.g[e][t]=a,this.optimal.m[e][t]=s,this.optimal.pi[e][t]=n)},bruteforceUpdate(r){let t=this.makeBruteforceMatch(0,r);this.update(t,1);for(let e=1;e<=r;e+=1){t=this.makeBruteforceMatch(e,r);const s=this.optimal.m[e-1];Object.keys(s).forEach(n=>{s[n].pattern!=="bruteforce"&&this.update(t,parseInt(n,10)+1)})}},unwind(r){const t=[];let e=r-1,s=0,n=1/0;const a=this.optimal.g[e];for(a&&Object.keys(a).forEach(o=>{const i=a[o];i<n&&(s=parseInt(o,10),n=i)});e>=0;){const o=this.optimal.m[e][s];t.unshift(o),e=o.i-1,s-=1}return t}};var _={mostGuessableMatchSequence(r,t,e=!1){x.password=r,x.excludeAdditive=e;const s=r.length;let n=x.fillArray(s,"array");t.forEach(c=>{n[c.j].push(c)}),n=n.map(c=>c.sort((l,u)=>l.i-u.i)),x.optimal={m:x.fillArray(s,"object"),pi:x.fillArray(s,"object"),g:x.fillArray(s,"object")};for(let c=0;c<s;c+=1)n[c].forEach(l=>{l.i>0?Object.keys(x.optimal.m[l.i-1]).forEach(u=>{x.update(l,parseInt(u,10)+1)}):x.update(l,1)}),x.bruteforceUpdate(c);const a=x.unwind(s),o=a.length,i=this.getGuesses(r,o);return{password:r,guesses:i,guessesLog10:D.log10(i),sequence:a}},getGuesses(r,t){const e=r.length;let s=0;return s=r.length===0?1:x.optimal.g[e-1][t],s}};class It{match({password:t,omniMatch:e}){const s=[];let n=0;for(;n<t.length;){const a=this.getGreedyMatch(t,n),o=this.getLazyMatch(t,n);if(a==null)break;const{match:i,baseToken:c}=this.setMatchToken(a,o);if(i){const l=i.index+i[0].length-1,u=this.getBaseGuesses(c,e);s.push(this.normalizeMatch(c,l,i,u)),n=l+1}}return s.some(a=>a instanceof Promise)?Promise.all(s):s}normalizeMatch(t,e,s,n){const a={pattern:"repeat",i:s.index,j:e,token:s[0],baseToken:t,baseGuesses:0,repeatCount:s[0].length/t.length};return n instanceof Promise?n.then(o=>({...a,baseGuesses:o})):{...a,baseGuesses:n}}getGreedyMatch(t,e){const s=/(.+)\1+/g;return s.lastIndex=e,s.exec(t)}getLazyMatch(t,e){const s=/(.+?)\1+/g;return s.lastIndex=e,s.exec(t)}setMatchToken(t,e){const s=/^(.+?)\1+$/;let n,a="";if(e&&t[0].length>e[0].length){n=t;const o=s.exec(n[0]);o&&(a=o[1])}else n=e,n&&(a=n[1]);return{match:n,baseToken:a}}getBaseGuesses(t,e){const s=e.match(t);return s instanceof Promise?s.then(n=>_.mostGuessableMatchSequence(t,n).guesses):_.mostGuessableMatchSequence(t,s).guesses}}class Dt{constructor(){this.MAX_DELTA=5}match({password:t}){const e=[];if(t.length===1)return[];let s=0,n=null;const a=t.length;for(let o=1;o<a;o+=1){const i=t.charCodeAt(o)-t.charCodeAt(o-1);if(n==null&&(n=i),i!==n){const c=o-1;this.update({i:s,j:c,delta:n,password:t,result:e}),s=c,n=i}}return this.update({i:s,j:a-1,delta:n,password:t,result:e}),e}update({i:t,j:e,delta:s,password:n,result:a}){if(e-t>1||Math.abs(s)===1){const o=Math.abs(s);if(o>0&&o<=this.MAX_DELTA){const i=n.slice(t,+e+1||9e9),{sequenceName:c,sequenceSpace:l}=this.getSequence(i);return a.push({pattern:"sequence",i:t,j:e,token:n.slice(t,+e+1||9e9),sequenceName:c,sequenceSpace:l,ascending:s>0})}}return null}getSequence(t){let e="unicode",s=26;return lt.test(t)?(e="lower",s=26):ct.test(t)?(e="upper",s=26):pt.test(t)&&(e="digits",s=10),{sequenceName:e,sequenceSpace:s}}}class At{constructor(){this.SHIFTED_RX=/[~!@#$%^&*()_+QWERTYUIOP{}|ASDFGHJKL:"ZXCVBNM<>?]/}match({password:t}){const e=[];return Object.keys(d.graphs).forEach(s=>{const n=d.graphs[s];L(e,this.helper(t,n,s))}),A(e)}checkIfShifted(t,e,s){return!t.includes("keypad")&&this.SHIFTED_RX.test(e.charAt(s))?1:0}helper(t,e,s){let n;const a=[];let o=0;const i=t.length;for(;o<i-1;){let c=o+1,l=0,u=0;for(n=this.checkIfShifted(s,t,o);;){const h=e[t.charAt(c-1)]||[];let p=!1,f=-1,y=-1;if(c<i){const w=t.charAt(c),g=h.length;for(let b=0;b<g;b+=1){const k=h[b];if(y+=1,k){const v=k.indexOf(w);if(v!==-1){p=!0,f=y,v===1&&(n+=1),l!==f&&(u+=1,l=f);break}}}}if(!p){c-o>2&&a.push({pattern:"spatial",i:o,j:c-1,token:t.slice(o,c),graph:s,turns:u,shiftedCount:n}),o=c;break}c+=1}}return a}}class Et{constructor(){this.matchers={date:mt,dictionary:xt,regex:vt,repeat:It,sequence:Dt,spatial:At}}match(t){const e=[],s=[];return[...Object.keys(this.matchers),...Object.keys(d.matchers)].forEach(n=>{if(!this.matchers[n]&&!d.matchers[n])return;const a=new(this.matchers[n]?this.matchers[n]:d.matchers[n].Matching)().match({password:t,omniMatch:this});a instanceof Promise?(a.then(o=>{L(e,o)}),s.push(a)):L(e,a)}),s.length>0?new Promise(n=>{Promise.all(s).then(()=>{n(A(e))})}):A(e)}}const Ct=2678400,Y=32140800,q={second:1,minute:60,hour:3600,day:86400,month:Ct,year:Y,century:100*Y};class Lt{translate(t,e){let s=t;e!==void 0&&e!==1&&(s+="s");const{timeEstimation:n}=d.translations;return n[s].replace("{base}",`${e}`)}estimateAttackTimes(t){const e={onlineThrottling100PerHour:t/.027777777777777776,onlineNoThrottling10PerSecond:t/10,offlineSlowHashing1e4PerSecond:t/1e4,offlineFastHashing1e10PerSecond:t/1e10},s={onlineThrottling100PerHour:"",onlineNoThrottling10PerSecond:"",offlineSlowHashing1e4PerSecond:"",offlineFastHashing1e10PerSecond:""};return Object.keys(e).forEach(n=>{const a=e[n];s[n]=this.displayTime(a)}),{crackTimesSeconds:e,crackTimesDisplay:s,score:this.guessesToScore(t)}}guessesToScore(t){return t<1005?0:t<1000005?1:t<100000005?2:t<10000000005?3:4}displayTime(t){let e,s="centuries";const n=Object.keys(q),a=n.findIndex(o=>t<q[o]);return a>-1&&(s=n[a-1],a!==0?e=Math.round(t/q[s]):s="ltSecond"),this.translate(s,e)}}var Ot=()=>null,Pt=()=>({warning:d.translations.warnings.dates,suggestions:[d.translations.suggestions.dates]});const _t=(r,t)=>{let e="";const s=r.dictionaryName,n=s==="lastnames"||s.toLowerCase().includes("firstnames");return s==="passwords"?e=((a,o)=>{let i="";return!o||a.l33t||a.reversed?a.guessesLog10<=4&&(i=d.translations.warnings.similarToCommon):i=a.rank<=10?d.translations.warnings.topTen:a.rank<=100?d.translations.warnings.topHundred:d.translations.warnings.common,i})(r,t):s.includes("wikipedia")?e=((a,o)=>{let i="";return o&&(i=d.translations.warnings.wordByItself),i})(0,t):n?e=((a,o)=>o?d.translations.warnings.namesByThemselves:d.translations.warnings.commonNames)(0,t):s==="userInputs"&&(e=d.translations.warnings.userInputs),e};var qt=(r,t)=>{const e=_t(r,t),s=[],n=r.token;return n.match($)?s.push(d.translations.suggestions.capitalization):n.match(G)&&n.toLowerCase()!==n&&s.push(d.translations.suggestions.allUppercase),r.reversed&&r.token.length>=4&&s.push(d.translations.suggestions.reverseWords),r.l33t&&s.push(d.translations.suggestions.l33t),{warning:e,suggestions:s}},Nt=r=>r.regexName==="recentYear"?{warning:d.translations.warnings.recentYears,suggestions:[d.translations.suggestions.recentYears,d.translations.suggestions.associatedYears]}:{warning:"",suggestions:[]},Wt=r=>{let t=d.translations.warnings.extendedRepeat;return r.baseToken.length===1&&(t=d.translations.warnings.simpleRepeat),{warning:t,suggestions:[d.translations.suggestions.repeated]}},zt=()=>({warning:d.translations.warnings.sequences,suggestions:[d.translations.suggestions.sequences]}),$t=r=>{let t=d.translations.warnings.keyPattern;return r.turns===1&&(t=d.translations.warnings.straightRow),{warning:t,suggestions:[d.translations.suggestions.longerKeyboardPattern]}};const V={warning:"",suggestions:[]};class Gt{constructor(){this.matchers={bruteforce:Ot,date:Pt,dictionary:qt,regex:Nt,repeat:Wt,sequence:zt,spatial:$t},this.defaultFeedback={warning:"",suggestions:[]},this.setDefaultSuggestions()}setDefaultSuggestions(){this.defaultFeedback.suggestions.push(d.translations.suggestions.useWords,d.translations.suggestions.noNeed)}getFeedback(t,e){if(e.length===0)return this.defaultFeedback;if(t>2)return V;const s=d.translations.suggestions.anotherWord,n=this.getLongestMatch(e);let a=this.getMatchFeedback(n,e.length===1);return a!=null?(a.suggestions.unshift(s),a.warning==null&&(a.warning="")):a={warning:"",suggestions:[s]},a}getLongestMatch(t){let e=t[0];return t.slice(1).forEach(s=>{s.token.length>e.token.length&&(e=s)}),e}getMatchFeedback(t,e){return this.matchers[t.pattern]?this.matchers[t.pattern](t,e):d.matchers[t.pattern]&&"feedback"in d.matchers[t.pattern]?d.matchers[t.pattern].feedback(t,e):V}}let N,F,B,H;N=()=>new Date().getTime(),F=(r,t)=>{const e=N(),s=((n,a)=>new Et().match(n))(r);if(s instanceof Promise)throw new Error("You are using a Promised matcher, please use `zxcvbnAsync` for it.");return((n,a,o)=>{const i=new Gt,c=new Lt,l=_.mostGuessableMatchSequence(a,n),u=N()-o,h=c.estimateAttackTimes(l.guesses);return{calcTime:u,...l,...h,feedback:i.getFeedback(h.score,l.sequence)}})(s,r,e)},B=["data-score"],H=X({name:"InputPassword"}),rt=Jt(X({...H,props:{strength:K.bool.def(!1),modelValue:K.string.def("")},emits:["update:modelValue"],setup(r,{emit:t}){const e=r,{getPrefixCls:s}=Ut(),n=s("input-password");J(()=>e.modelValue,h=>{h!==M(c)&&(c.value=h)});const{configGlobal:a}={configGlobal:Rt("configGlobal",{})},o=Q("password"),i=()=>{o.value=M(o)==="text"?"password":"text"},c=Q(e.modelValue);J(()=>c.value,h=>{t("update:modelValue",h)});const l=tt(()=>{const h=M(c),p=F(M(c));return h?p.score:-1}),u=tt(()=>M(o)==="password"?"ep:hide":"ep:view");return(h,p)=>{var w;const f=Xt,y=Zt;return et(),st("div",{class:W([M(n),`${M(n)}--${(w=M(a))==null?void 0:w.size}`])},[nt(y,Vt({modelValue:M(c),"onUpdate:modelValue":p[0]||(p[0]=g=>Ft(c)?c.value=g:null),type:M(o)},h.$attrs),{suffix:Yt(()=>[nt(f,{icon:M(u),class:"el-input__icon cursor-pointer",onClick:i},null,8,["icon"])]),_:1},16,["modelValue","type"]),r.strength?(et(),st("div",{key:0,class:W([`${M(n)}__bar`,"relative h-6px mt-10px mb-6px mr-auto ml-auto"])},[Bt("div",{class:W(`${M(n)}__bar--fill`),"data-score":M(l)},null,10,B)],2)):Ht("",!0)],2)}}}),[["__scopeId","data-v-6eb2d99d"]])});export{rt as I,Qt as __tla};
