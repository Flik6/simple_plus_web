import{aQ as g,d as k,r as A,D,e as W,o as C,c as q,g as a,w as e,a as h,A as j,F as G,j as X,H as Z,f as i,Q as z,I as B,J as N,K as $,M as aa,q as ea,v as ta,__tla as la}from"./index-B2l-tRNr.js";import{E as sa,__tla as ra}from"./el-card-DXk2QVka.js";import{_ as na,__tla as ua}from"./Echart.vue_vue_type_script_name_EChart_setup_true_lang-DCCJG-dr.js";import{_ as oa,__tla as da}from"./ContentWrap.vue_vue_type_script_name_ContentWrap_setup_true_lang-CKAf4vXg.js";import{c as ia,e as ca,g as Q,f as o,h as ma,__tla as pa}from"./formatTime-U2F_5HmG.js";import{f as _a,__tla as ha}from"./index-DtbXdAaO.js";import{u as va,__tla as fa}from"./useMessage-CCK8Vpo2.js";import"./installCanvasRenderer-DVt2nqFI.js";let H,xa=Promise.all([(()=>{try{return la}catch{}})(),(()=>{try{return ra}catch{}})(),(()=>{try{return ua}catch{}})(),(()=>{try{return da}catch{}})(),(()=>{try{return pa}catch{}})(),(()=>{try{return ha}catch{}})(),(()=>{try{return fa}catch{}})()]).then(async()=>{let I,Y,M,U,V;I=i("div",null,[i("span",null,"\u7528\u6237\u589E\u51CF\u6570\u636E")],-1),Y=i("div",null,[i("span",null,"\u7D2F\u8BA1\u7528\u6237\u6570\u636E")],-1),M=i("div",null,[i("span",null,"\u6D88\u606F\u6982\u51B5\u6570\u636E")],-1),U=i("div",null,[i("span",null,"\u63A5\u53E3\u5206\u6790\u6570\u636E")],-1),V=k({name:"MpStatistics"}),H=k({...V,setup(ya){const F=va(),t=A([ia(new Date(new Date().getTime()-6048e5)),ca(new Date(new Date().getTime()-864e5))]),d=A(),x=A([]),c=A([]),m=D({color:["#67C23A","#E5323E"],legend:{data:["\u65B0\u589E\u7528\u6237","\u53D6\u6D88\u5173\u6CE8\u7684\u7528\u6237"]},tooltip:{},xAxis:{data:[]},yAxis:{minInterval:1},series:[{name:"\u65B0\u589E\u7528\u6237",type:"bar",label:{show:!0},barGap:0,data:[]},{name:"\u53D6\u6D88\u5173\u6CE8\u7684\u7528\u6237",type:"bar",label:{show:!0},data:[]}]}),f=D({legend:{data:["\u7D2F\u8BA1\u7528\u6237\u91CF"]},xAxis:{type:"category",data:[]},yAxis:{minInterval:1},series:[{name:"\u7D2F\u8BA1\u7528\u6237\u91CF",data:[],type:"line",smooth:!0,label:{show:!0}}]}),p=D({color:["#67C23A","#E5323E"],legend:{data:["\u7528\u6237\u53D1\u9001\u4EBA\u6570","\u7528\u6237\u53D1\u9001\u6761\u6570"]},tooltip:{},xAxis:{data:[]},yAxis:{minInterval:1},series:[{name:"\u7528\u6237\u53D1\u9001\u4EBA\u6570",type:"line",smooth:!0,label:{show:!0},data:[]},{name:"\u7528\u6237\u53D1\u9001\u6761\u6570",type:"line",smooth:!0,label:{show:!0},data:[]}]}),u=D({color:["#67C23A","#E5323E","#E6A23C","#409EFF"],legend:{data:["\u88AB\u52A8\u56DE\u590D\u7528\u6237\u6D88\u606F\u7684\u6B21\u6570","\u5931\u8D25\u6B21\u6570","\u6700\u5927\u8017\u65F6","\u603B\u8017\u65F6"]},tooltip:{},xAxis:{data:[]},yAxis:{},series:[{name:"\u88AB\u52A8\u56DE\u590D\u7528\u6237\u6D88\u606F\u7684\u6B21\u6570",type:"bar",label:{show:!0},barGap:0,data:[]},{name:"\u5931\u8D25\u6B21\u6570",type:"bar",label:{show:!0},data:[]},{name:"\u6700\u5927\u8017\u65F6",type:"bar",label:{show:!0},data:[]},{name:"\u603B\u8017\u65F6",type:"bar",label:{show:!0},data:[]}]}),E=()=>{if(!d)return F.error("\u672A\u9009\u4E2D\u516C\u4F17\u53F7\uFF0C\u65E0\u6CD5\u7EDF\u8BA1\u6570\u636E"),!1;if(Q(t.value[0],t.value[1])>=7)return F.error("\u65F6\u95F4\u95F4\u9694 7 \u5929\u4EE5\u5185\uFF0C\u8BF7\u91CD\u65B0\u9009\u62E9"),!1;c.value=[];const s=Q(t.value[0],t.value[1]);for(let l=0;l<=s;l++)c.value.push(o(ma(t.value[0],864e5*l),"YYYY-MM-DD"));J(),K(),O(),R()},J=async()=>{m.xAxis.data=[],m.series[0].data=[],m.series[1].data=[];try{const l=await(s={accountId:d.value,date:[o(t.value[0]),o(t.value[1])]},g.get({url:"/mp/statistics/user-summary",params:s}));m.xAxis.data=c.value,c.value.forEach((n,r)=>{l.forEach(v=>{o(new Date(v.refDate),"YYYY-MM-DD").indexOf(n)!==-1&&(m.series[0].data[r]=v.newUser,m.series[1].data[r]=v.cancelUser)})})}catch{}var s},K=async()=>{f.xAxis.data=[],f.series[0].data=[];try{const l=await(s={accountId:d.value,date:[o(t.value[0]),o(t.value[1])]},g.get({url:"/mp/statistics/user-cumulate",params:s}));f.xAxis.data=c.value,l.forEach((n,r)=>{f.series[0].data[r]=n.cumulateUser})}catch{}var s},O=async()=>{p.xAxis.data=[],p.series[0].data=[],p.series[1].data=[];try{const l=await(s={accountId:d.value,date:[o(t.value[0]),o(t.value[1])]},g.get({url:"/mp/statistics/upstream-message",params:s}));p.xAxis.data=c.value,l.forEach((n,r)=>{p.series[0].data[r]=n.messageUser,p.series[1].data[r]=n.messageCount})}catch{}var s},R=async()=>{u.xAxis.data=[],u.series[0].data=[],u.series[1].data=[],u.series[2].data=[],u.series[3].data=[];try{const l=await(s={accountId:d.value,date:[o(t.value[0]),o(t.value[1])]},g.get({url:"/mp/statistics/interface-summary",params:s}));u.xAxis.data=c.value,l.forEach((n,r)=>{u.series[0].data[r]=n.callbackCount,u.series[1].data[r]=n.failCount,u.series[2].data[r]=n.maxTimeCost,u.series[3].data[r]=n.totalTimeCost})}catch{}var s};return W(async()=>{await(async()=>{x.value=await _a(),x.value.length>0&&(d.value=x.value[0].id)})(),E()}),(s,l)=>{const n=z,r=B,v=N,S=$,L=aa,T=oa,y=na,b=sa,w=ea,P=ta;return C(),q(G,null,[a(T,null,{default:e(()=>[a(L,{class:"-mb-15px",ref:"queryForm",inline:!0,"label-width":"68px"},{default:e(()=>[a(v,{label:"\u516C\u4F17\u53F7",prop:"accountId"},{default:e(()=>[a(r,{modelValue:h(d),"onUpdate:modelValue":l[0]||(l[0]=_=>j(d)?d.value=_:null),onChange:E,class:"!w-240px"},{default:e(()=>[(C(!0),q(G,null,X(h(x),_=>(C(),Z(n,{key:_.id,label:_.name,value:_.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(v,{label:"\u65F6\u95F4\u8303\u56F4",prop:"dateRange"},{default:e(()=>[a(S,{modelValue:h(t),"onUpdate:modelValue":l[1]||(l[1]=_=>j(t)?t.value=_:null),type:"daterange","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],onChange:E,class:"!w-240px"},null,8,["modelValue","default-time"])]),_:1})]),_:1},512)]),_:1}),a(T,null,{default:e(()=>[a(P,null,{default:e(()=>[a(w,{span:12,class:"card-box"},{default:e(()=>[a(b,null,{header:e(()=>[I]),default:e(()=>[a(y,{options:h(m),height:420},null,8,["options"])]),_:1})]),_:1}),a(w,{span:12,class:"card-box"},{default:e(()=>[a(b,null,{header:e(()=>[Y]),default:e(()=>[a(y,{options:h(f),height:420},null,8,["options"])]),_:1})]),_:1}),a(w,{span:12,class:"card-box"},{default:e(()=>[a(b,null,{header:e(()=>[M]),default:e(()=>[a(y,{options:h(p),height:420},null,8,["options"])]),_:1})]),_:1}),a(w,{span:12,class:"card-box"},{default:e(()=>[a(b,null,{header:e(()=>[U]),default:e(()=>[a(y,{options:h(u),height:420},null,8,["options"])]),_:1})]),_:1})]),_:1})]),_:1})],64)}}})});export{xa as __tla,H as default};
