import{r as o,a0 as Te,am as Se,o as r,c as m,F,j as q,f as p,g as l,i as x,a as V,ax as le,w as t,h as f,A as te,B as N,t as ue,d as Ne,a2 as P,_ as je,H as Ie,x as Ae,y as Ee,a3 as Ue,m as Fe,a4 as qe,n as Ge,a8 as $e,a9 as Je,a5 as Le,a6 as Me,a7 as Oe,a1 as He,cm as Qe,L as De,q as Ke,s as Re,__tla as We}from"./index-IVPz-ih6.js";import{E as Xe,__tla as Ye}from"./el-card-Cr59IUNy.js";import{E as Ze,__tla as ea}from"./el-image-BULbPLoM.js";import{__tla as aa}from"./el-image-viewer-CT2z8sww.js";import{g as la,d as ta,p as ua,b as na,a as ia,e as sa,c as oa,__tla as ca}from"./material-84p6d2D3.js";import{_ as ra}from"./_plugin-vue_export-helper-BCo6x5W8.js";let ne,da=Promise.all([(()=>{try{return We}catch{}})(),(()=>{try{return Ye}catch{}})(),(()=>{try{return ea}catch{}})(),(()=>{try{return aa}catch{}})(),(()=>{try{return ca}catch{}})()]).then(async()=>{let G,$,J,L,M,O,H,Q,D,K,R,W;G={key:0},$=["src"],J={class:"el-upload-list__item-actions"},L=["onClick"],M=["onClick"],O=(d=>(Ke("data-v-35a5f10a"),d=d(),Re(),d))(()=>p("i",{class:"el-icon-view"},null,-1)),H=["onClick"],Q=["onClick"],D={style:{"margin-bottom":"10px"}},K={key:0},R={class:"dialog-footer"},W=Ne({name:"Materials"}),ne=ra(Object.assign(W,{props:{modelValue:{type:Array,default:()=>[]},type:{type:String},num:{type:Number,default:()=>5},width:{type:Number,default:()=>150},height:{type:Number,default:()=>150}},emits:["update:modelValue"],setup(d,{emit:j}){const h=d,ie=o({Authorization:"Bearer "+Te()}),se=o(!1),oe=o(""),k=o(!1),ce=o(!1),w=o([]),I=o(""),v=o({}),A=o(!1),B=o([]),X=o(0),s=o({total:0,currentPage:1,pageSize:12,ascs:[],descs:"create_time"}),T=o(!1),b=o(null),y=o([]),i=Se({get:()=>h.modelValue&&h.modelValue.length!=0?Array.isArray(h.modelValue)?h.modelValue:[h.modelValue]:[]});function Y(e,a){if(a=="up"){const c=i.value[e-1];i.value[e-1]=i.value[e],i.value[e]=c}if(a=="down"){const c=i.value[e+1];i.value[e+1]=i.value[e],i.value[e]=c}}function re(){k.value=!0,ce.value=!0,B.value.length<=0&&E()}function E(){A.value=!0,la({total:0,pageNo:1,pageSize:100,ascs:[],sort:"create_time,desc"}).then(e=>{A.value=!1,w.value=e,w.value.unshift({id:"-1",name:"\u5168\u90E8\u5206\u7EC4"}),Z({index:0})})}function Z(e){y.value=[];const a=Number(e.index);v.value=w.value[a],v.value.index=a,I.value=v.value.id,s.value.currentPage=1,s.value.total=0,v.value.id!="-1"?b.value=v.value.id:b.value=null,z(s.value)}function z(e){T.value=!0,ia(Object.assign({pageNo:e.currentPage,pageSize:e.pageSize,descs:e.descs,ascs:e.ascs,sort:"create_time,desc"},{groupId:b.value})).then(a=>{s.value.total=a.total,s.value.currentPage=e.currentPage,s.value.pageSize=e.pageSize,B.value=a.list,T.value=!1}).catch(a=>{T.value=!1})}function de(e){s.value.currentPage=1,s.value.pageSize=e,z(this.page)}function pe(e){s.value.currentPage=e,z(s.value)}function me(e){}function ve(e,a,c){oa({type:"1",groupId:b.value!="-1"?b.value:null,name:a.name,url:e.data}).then(()=>{X.value++,c.length===X.value&&z(s.value)})}function fe(e){const a=e.type==="image/jpeg"||e.type==="image/png"||e.type==="image/gif"||e.type==="image/jpg",c=e.size/1024/1024<2;return a?(c||this.$message.error("\u4E0A\u4F20\u5934\u50CF\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 2MB!"),a&&c):(this.$message.error("\u4E0A\u4F20\u56FE\u7247\u53EA\u80FD\u662F JPG\u3001JPEG\u3001PNG\u3001GIF \u683C\u5F0F!"),!1)}function ge(){y.value.forEach(e=>{i.value[i.value.length]=e}),k.value=!1,y.value.length>1||h.num>1?j("update:modelValue",i.value):j("update:modelValue",i.value[0])}return(e,a)=>{const c=je,g=Ie,_e=Ae,he=Ee,ye=Ue,S=Fe,xe=qe,U=Ge,ke=$e,we=Ze,be=Je,ee=Xe,ze=Le,Ce=Me,Ve=Oe,Pe=He,Be=Qe,ae=De;return d.type=="image"?(r(),m("div",G,[(r(!0),m(F,null,q(V(i),(u,n)=>(r(),m("ul",{key:n,class:"el-upload-list el-upload-list--picture-card"},[p("li",{tabindex:"0",class:"el-upload-list__item is-ready",style:le("width: "+d.width+"px;height: "+d.height+"px")},[p("div",null,[p("img",{src:u,alt:"",class:"el-upload-list__item-thumbnail"},null,8,$),p("span",J,[n!=0?(r(),m("span",{key:0,class:"el-upload-list__item-preview",onClick:_=>Y(n,"up")},[l(c,{icon:"ep:back"})],8,L)):x("",!0),p("span",{class:"el-upload-list__item-preview",onClick:_=>function(C){se.value=!0,oe.value=i.value[C]}(n)},[O,l(c,{icon:"ep:view"})],8,M),p("span",{class:"el-upload-list__item-delete",onClick:_=>function(C){P.confirm("\u662F\u5426\u786E\u8BA4\u5220\u9664\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(function(){i.value.splice(C,1),y.value=[],j("update:modelValue",i.value)})}(n)},[l(c,{icon:"ep:delete"})],8,H),n!=V(i).length-1?(r(),m("span",{key:1,class:"el-upload-list__item-preview",onClick:_=>Y(n,"down")},[l(c,{icon:"ep:right"})],8,Q)):x("",!0)])])],4)]))),128)),d.num>V(i).length?(r(),m("div",{key:0,tabindex:"0",class:"el-upload el-upload--picture-card",style:le("width: "+d.width+"px;height: "+d.height+"px;line-height:"+d.height+"px;"),onClick:re},[l(c,{icon:"ep:plus"})],4)):x("",!0),l(Be,{title:"\u56FE\u7247\u7D20\u6750\u5E93","append-to-body":"",modelValue:k.value,"onUpdate:modelValue":a[7]||(a[7]=u=>k.value=u),width:"70%"},{footer:t(()=>[p("span",R,[l(g,{onClick:a[6]||(a[6]=u=>k.value=!1)},{default:t(()=>[f("\u53D6 \u6D88")]),_:1}),l(g,{type:"primary",onClick:ge},{default:t(()=>[f("\u786E \u5B9A")]),_:1})])]),default:t(()=>[l(Pe,null,{default:t(()=>[l(ye,{width:"100px"},{default:t(()=>[p("div",D,[l(g,{class:"el-icon-plus",size:"small",onClick:a[0]||(a[0]=u=>{P.prompt("\u8BF7\u8F93\u5165\u5206\u7EC4\u540D","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88"}).then(({value:n})=>{na({name:n}).then(function(){E()})}).catch(()=>{})})},{default:t(()=>[f(" \u6DFB\u52A0\u5206\u7EC4 ")]),_:1})]),te((r(),N(he,{modelValue:I.value,"onUpdate:modelValue":a[1]||(a[1]=u=>I.value=u),"tab-position":"left",onTabClick:Z},{default:t(()=>[(r(!0),m(F,null,q(w.value,u=>(r(),N(_e,{key:u.id,name:u.id},{label:t(()=>[p("span",null,ue(u.name),1)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])),[[ae,A.value]])]),_:1}),l(Ve,null,{default:t(()=>[l(ee,null,{header:t(()=>[p("div",null,[l(U,null,{default:t(()=>[l(S,{span:12},{default:t(()=>[p("span",null,ue(v.value.name),1),v.value.id!="-1"?(r(),m("span",K,[l(g,{size:"small",type:"text",class:"el-icon-edit",style:{"margin-left":"10px"},onClick:a[2]||(a[2]=u=>{return n=v.value,void P.prompt("\u8BF7\u8F93\u5165\u5206\u7EC4\u540D","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",inputValue:n.name}).then(({value:_})=>{ua({id:n.id,name:_}).then(function(){n.name=_,w.value[n.index]=n})}).catch(()=>{});var n})},{default:t(()=>[f("\u91CD\u547D\u540D")]),_:1}),l(g,{size:"small",type:"text",class:"el-icon-delete",style:{"margin-left":"10px",color:"red"},onClick:a[3]||(a[3]=u=>{return n=v.value,void P.confirm("\u662F\u5426\u786E\u8BA4\u5220\u9664\u8BE5\u5206\u7EC4\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(function(){ta(n.id).then(function(){E()})});var n})},{default:t(()=>[f("\u5220\u9664")]),_:1})])):x("",!0)]),_:1}),l(S,{span:12,style:{"text-align":"right"}},{default:t(()=>[l(xe,{action:V("https://nq.92coco.cn:8443/admin-api/infra/file/upload"),headers:ie.value,"file-list":[],"on-progress":me,"before-upload":fe,"on-success":ve,data:{type:1},multiple:""},{default:t(()=>[l(g,{size:"small",type:"primary"},{default:t(()=>[f("\u6279\u91CF\u4E0A\u4F20")]),_:1})]),_:1},8,["action","headers"])]),_:1})]),_:1})])]),default:t(()=>[te((r(),m("div",null,[B.value.length<=0?(r(),N(ke,{key:0,title:"\u6682\u65E0\u6570\u636E",type:"info",closable:!1,center:"","show-icon":""})):x("",!0),l(ze,{modelValue:y.value,"onUpdate:modelValue":a[4]||(a[4]=u=>y.value=u),max:d.num-V(i).length},{default:t(()=>[l(U,{gutter:5},{default:t(()=>[(r(!0),m(F,null,q(B.value,(u,n)=>(r(),N(S,{key:n,span:4},{default:t(()=>[l(ee,{"body-style":{padding:"5px"}},{default:t(()=>[l(we,{style:{width:"100%",height:"100px"},src:u.url,fit:"contain","preview-src-list":[u.url],"z-index":9999},null,8,["src","preview-src-list"]),p("div",null,[l(be,{class:"material-name",label:u.url},{default:t(()=>[f(" \u9009\u62E9 ")]),_:2},1032,["label"]),l(U,null,{default:t(()=>[l(S,{span:24,class:"col-do"},{default:t(()=>[l(g,{type:"text",size:"medium",onClick:_=>function(C){P.confirm("\u662F\u5426\u786E\u8BA4\u5220\u9664\u8BE5\u7D20\u6750\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(function(){sa(C.id).finally(function(){z(s.value)})})}(u)},{default:t(()=>[f("\u5220\u9664")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue","max"]),l(Ce,{"current-page":s.value.currentPage,"onUpdate:currentPage":a[5]||(a[5]=u=>s.value.currentPage=u),"page-sizes":[12,24],"page-size":s.value.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:s.value.total,class:"pagination",onSizeChange:de,onCurrentChange:pe},null,8,["current-page","page-size","total"])])),[[ae,T.value]])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])):x("",!0)}}}),[["__scopeId","data-v-35a5f10a"]])});export{ne as _,da as __tla};
