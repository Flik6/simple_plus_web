import{aQ as Ae,d as fe,r as g,z as J,e as Je,o as a,B as Me,w as o,f as i,a as t,A as Ie,c as l,i as x,F as Pe,j as Ze,V as we,t as m,ax as We,g as c,h as u,v as ze,ay as be,E as je,H as Ke,L as Ue,q as Ve,s as qe,__tla as Ce}from"./index-IVPz-ih6.js";import{_ as Ge,__tla as Re}from"./ContentWrap.vue_vue_type_script_name_ContentWrap_setup_true_lang-bBfHsZA1.js";import{E as Se,__tla as He}from"./el-link-BBBzy44y.js";import Qe,{__tla as De}from"./main-BY4VNtVO.js";import{_ as Te,__tla as Ye}from"./main.vue_vue_type_script_setup_true_name_WxVideoPlayer_lang-Ki_2MbjD.js";import Fe,{__tla as Oe}from"./main-D879jax-.js";import Xe,{__tla as $e}from"./main-Ba5sMQyK.js";import{_ as et,__tla as tt}from"./main.vue_vue_type_script_setup_true_name_WxLocation_lang-tCCjV770.js";import at,{__tla as lt}from"./main-gpgWGI1F.js";import{g as st,__tla as nt}from"./index-WR3Vj4ow.js";import{f as ct,__tla as rt}from"./formatTime-C0hHcWKm.js";import{M as s}from"./types-VQvH2Qnl.js";import{u as it,__tla as ut}from"./useMessage-DmGM48R-.js";import{_ as ot}from"./_plugin-vue_export-helper-BCo6x5W8.js";let M,P,Ee,dt=Promise.all([(()=>{try{return Ce}catch{}})(),(()=>{try{return Re}catch{}})(),(()=>{try{return He}catch{}})(),(()=>{try{return De}catch{}})(),(()=>{try{return Ye}catch{}})(),(()=>{try{return Oe}catch{}})(),(()=>{try{return $e}catch{}})(),(()=>{try{return tt}catch{}})(),(()=>{try{return lt}catch{}})(),(()=>{try{return nt}catch{}})(),(()=>{try{return rt}catch{}})(),(()=>{try{return ut}catch{}})()]).then(async()=>{let b,Z,w,W,z,j,K,U,V,q,C,G,R,S,H,Q,D,T,Y,F,O,X,$,ee,te,ae,le,se,ne,ce,re,ie,ue,oe,de,ve,me,pe;P=y=>Ae.get({url:"/mp/message/page",params:y}),b=y=>(Ve("data-v-d85fb2e8"),y=y(),qe(),y),Z=["id"],w={key:0},W=[b(()=>i("span",{class:"el-table__empty-text"},"\u70B9\u51FB\u52A0\u8F7D\u66F4\u591A",-1))],z={key:1,class:"el-table__empty-block"},j=[b(()=>i("span",{class:"el-table__empty-text"},"\u6CA1\u6709\u66F4\u591A\u4E86",-1))],K={class:"avatar-div"},U=["src"],V={class:"avue-comment__author"},q={class:"avue-comment__main"},C={class:"avue-comment__header"},G={class:"avue-comment__create_time"},R={key:0},S={key:1},H={key:2},Q={key:3},D={key:4},T={key:5},Y={key:6},F={key:7},O={key:8},X={key:9},$={key:10},ee={key:11},te={key:12},ae={key:13},le=["href"],se=["src"],ne={key:14,style:{"text-align":"center"}},ce={key:15,class:"avue-card__detail"},re={class:"avue-card__title"},ie=b(()=>i("i",{class:"el-icon-link"},null,-1)),ue={class:"avue-card__info",style:{height:"unset"}},oe={key:16},de={key:17,style:{width:"300px"}},ve={key:18},me={class:"msg-send"},pe=fe({name:"WxMsg"}),M=ot(fe({...pe,props:{userId:{type:Number,required:!0}},setup(y){const L=y,Ne=it(),E=g(new Date().getTime()),N=g(!1),B=g(!0),A=g([]),p=J({pageNo:1,pageSize:14,accountId:void 0}),_=J({nickname:"\u7528\u6237",avatar:"/assets/profile-BiJdjH9E.jpg",accountId:0}),_e=J({nickname:"\u516C\u4F17\u53F7",avatar:"data:image/png;base64,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"}),ye=g(!1),d=g({type:s.Text,accountId:null,articles:[]}),ge=g(null);Je(async()=>{var v,r;const n=await st(L.userId);_.nickname=((v=n.nickname)==null?void 0:v.length)>0?n.nickname:_.nickname,_.avatar=((r=_.avatar)==null?void 0:r.length)>0?n.avatar:_.avatar,_.accountId=n.accountId,p.accountId=n.accountId,d.value.accountId=n.accountId,Be()});const xe=async()=>{var v;if(!d)return;d.value.type===s.News&&d.value.articles.length>1&&(d.value.articles=[d.value.articles[0]],Ne.success("\u56FE\u6587\u6D88\u606F\u6761\u6570\u9650\u5236\u5728 1 \u6761\u4EE5\u5185\uFF0C\u5DF2\u9ED8\u8BA4\u53D1\u9001\u7B2C\u4E00\u6761"));const n=await(r=>Ae.post({url:"/mp/message/send",data:r}))({userId:L.userId,...d.value});ye.value=!1,A.value=[...A.value,n],he(),(v=ge.value)==null||v.clear()},Le=()=>{p.pageNo++,ke(p,null)},ke=async(n,v)=>{N.value=!0;let r=await P(Object.assign({pageNo:n.pageNo,pageSize:n.pageSize,userId:L.userId,accountId:n.accountId},v));const k=document.getElementById("msg-div"+E.value);let f=0;k&&(f=k.scrollHeight);const h=r.list.reverse();A.value=[...h,...A.value],N.value=!1,(h.length<p.pageSize||h.length===0)&&(B.value=!1),p.pageNo=n.pageNo,p.pageSize=n.pageSize,p.pageNo===1?he():h.length!==0&&await be(()=>{if(f!==0){let I=document.getElementById("msg-div"+E.value);I&&k&&(k.scrollTop=I.scrollHeight-f-100)}})},Be=()=>{ke(p,null)},he=()=>{be(()=>{let n=document.getElementById("msg-div"+E.value);n&&(n.scrollTop=n.scrollHeight)})};return(n,v)=>{const r=je,k=Se,f=Ke,h=Ge,I=Ue;return a(),Me(h,null,{default:o(()=>[i("div",{class:"msg-div",id:"msg-div"+t(E)},[Ie(i("div",null,null,512),[[I,t(N)]]),t(N)?x("",!0):(a(),l("div",w,[t(B)?(a(),l("div",{key:0,class:"el-table__empty-block",onClick:Le},W)):x("",!0),t(B)?x("",!0):(a(),l("div",z,j))])),(a(!0),l(Pe,null,Ze(t(A),e=>(a(),l("div",{class:"execution",key:e.id},[i("div",{class:we(["avue-comment",e.sendFrom===2?"avue-comment--reverse":""])},[i("div",K,[i("img",{src:e.sendFrom===1?t(_).avatar:t(_e).avatar,class:"avue-comment__avatar"},null,8,U),i("div",V,m(e.sendFrom===1?t(_).nickname:t(_e).nickname),1)]),i("div",q,[i("div",C,[i("div",G,m(t(ct)(e.createTime)),1)]),i("div",{class:"avue-comment__body",style:We(e.sendFrom===2?"background: #6BED72;":"")},[e.type===t(s).Event&&e.event==="subscribe"?(a(),l("div",R,[c(r,{type:"success"},{default:o(()=>[u("\u5173\u6CE8")]),_:1})])):e.type===t(s).Event&&e.event==="unsubscribe"?(a(),l("div",S,[c(r,{type:"danger"},{default:o(()=>[u("\u53D6\u6D88\u5173\u6CE8")]),_:1})])):e.type===t(s).Event&&e.event==="CLICK"?(a(),l("div",H,[c(r,null,{default:o(()=>[u("\u70B9\u51FB\u83DC\u5355")]),_:1}),u(" \u3010"+m(e.eventKey)+"\u3011 ",1)])):e.type===t(s).Event&&e.event==="VIEW"?(a(),l("div",Q,[c(r,null,{default:o(()=>[u("\u70B9\u51FB\u83DC\u5355\u94FE\u63A5")]),_:1}),u(" \u3010"+m(e.eventKey)+"\u3011 ",1)])):e.type===t(s).Event&&e.event==="scancode_waitmsg"?(a(),l("div",D,[c(r,null,{default:o(()=>[u("\u626B\u7801\u7ED3\u679C")]),_:1}),u(" \u3010"+m(e.eventKey)+"\u3011 ",1)])):e.type===t(s).Event&&e.event==="scancode_push"?(a(),l("div",T,[c(r,null,{default:o(()=>[u("\u626B\u7801\u7ED3\u679C")]),_:1}),u(" \u3010"+m(e.eventKey)+"\u3011 ",1)])):e.type===t(s).Event&&e.event==="pic_sysphoto"?(a(),l("div",Y,[c(r,null,{default:o(()=>[u("\u7CFB\u7EDF\u62CD\u7167\u53D1\u56FE")]),_:1})])):e.type===t(s).Event&&e.event==="pic_photo_or_album"?(a(),l("div",F,[c(r,null,{default:o(()=>[u("\u62CD\u7167\u6216\u8005\u76F8\u518C")]),_:1})])):e.type===t(s).Event&&e.event==="pic_weixin"?(a(),l("div",O,[c(r,null,{default:o(()=>[u("\u5FAE\u4FE1\u76F8\u518C")]),_:1})])):e.type===t(s).Event&&e.event==="location_select"?(a(),l("div",X,[c(r,null,{default:o(()=>[u("\u9009\u62E9\u5730\u7406\u4F4D\u7F6E")]),_:1})])):e.type===t(s).Event?(a(),l("div",$,[c(r,{type:"danger"},{default:o(()=>[u("\u672A\u77E5\u4E8B\u4EF6\u7C7B\u578B")]),_:1})])):e.type===t(s).Text?(a(),l("div",ee,m(e.content),1)):e.type===t(s).Voice?(a(),l("div",te,[c(t(Fe),{url:e.mediaUrl,content:e.recognition},null,8,["url","content"])])):e.type===t(s).Image?(a(),l("div",ae,[i("a",{target:"_blank",href:e.mediaUrl},[i("img",{src:e.mediaUrl,style:{width:"100px"}},null,8,se)],8,le)])):e.type===t(s).Video||e.type==="shortvideo"?(a(),l("div",ne,[c(t(Te),{url:e.mediaUrl},null,8,["url"])])):e.type===t(s).Link?(a(),l("div",ce,[c(k,{type:"success",underline:!1,target:"_blank",href:e.url},{default:o(()=>[i("div",re,[ie,u(m(e.title),1)])]),_:2},1032,["href"]),i("div",ue,m(e.description),1)])):e.type===t(s).Location?(a(),l("div",oe,[c(t(et),{label:e.label,"location-y":e.locationY,"location-x":e.locationX},null,8,["label","location-y","location-x"])])):e.type===t(s).News?(a(),l("div",de,[c(t(Xe),{articles:e.articles},null,8,["articles"])])):e.type===t(s).Music?(a(),l("div",ve,[c(t(at),{title:e.title,description:e.description,"thumb-media-url":e.thumbMediaUrl,"music-url":e.musicUrl,"hq-music-url":e.hqMusicUrl},null,8,["title","description","thumb-media-url","music-url","hq-music-url"])])):x("",!0)],4)])],2)]))),128))],8,Z),Ie((a(),l("div",me,[c(t(Qe),{ref_key:"replySelectRef",ref:ge,modelValue:t(d),"onUpdate:modelValue":v[0]||(v[0]=e=>ze(d)?d.value=e:null)},null,8,["modelValue"]),c(f,{type:"success",class:"send-but",onClick:xe},{default:o(()=>[u("\u53D1\u9001(S)")]),_:1})])),[[I,t(ye)]])]),_:1})}}}),[["__scopeId","data-v-d85fb2e8"]]),Ee=Object.freeze(Object.defineProperty({__proto__:null,default:M},Symbol.toStringTag,{value:"Module"}))});export{M as W,dt as __tla,P as g,Ee as m};
