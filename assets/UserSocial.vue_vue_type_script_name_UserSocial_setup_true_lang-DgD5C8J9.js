import{d as m,$ as n,am as N,o as d,B as _,w as h,ai as P,a as U,b6 as Q,H as T,i as q,h as k,t as B,_ as X,aQ as b,r as F,N as $,e as z,ab as A,K as D,g as u,f as O,c as S,F as R,J as E,__tla as G}from"./index-IVPz-ih6.js";import{_ as L}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{S as V}from"./constants-BjZq39Lm.js";import{g as M,__tla as W}from"./profile-CmFpbkzc.js";import{u as Y,__tla as Z}from"./useMessage-DmGM48R-.js";let j,tt=Promise.all([(()=>{try{return G}catch{}})(),(()=>{try{return W}catch{}})(),(()=>{try{return Z}catch{}})()]).then(async()=>{let w,C,I,v,x;w=m({name:"XTextButton"}),C=L(m({...w,props:{modelValue:n.bool.def(!1),loading:n.bool.def(!1),preIcon:n.string.def(""),postIcon:n.string.def(""),title:n.string.def(""),type:n.oneOf(["","primary","success","warning","danger","info"]).def("primary"),circle:n.bool.def(!1),round:n.bool.def(!1),plain:n.bool.def(!1),onClick:{type:Function,default:null}},setup(l){const y=l,f=N(()=>{const r=["title","preIcon","postIcon","onClick"],c={...Q(),...y};for(const a in c)r.indexOf(a)!==-1&&delete c[a];return c});return(r,c)=>{const a=X,g=T;return d(),_(g,P({link:""},U(f),{onClick:l.onClick}),{default:h(()=>[l.preIcon?(d(),_(a,{key:0,icon:l.preIcon,class:"mr-1px"},null,8,["icon"])):q("",!0),k(" "+B(l.title?l.title:"")+" ",1),l.postIcon?(d(),_(a,{key:1,icon:l.postIcon,class:"mr-1px"},null,8,["icon"])):q("",!0)]),_:1},16,["onClick"])}}}),[["__scopeId","data-v-b7a8347d"]]),I=["src"],v={class:"mr-5"},x=m({name:"UserSocial"}),j=m({...x,setup(l){const y=Y(),f=F([]),r=F(),c=async()=>{var s;const e=await M();r.value=e;for(const t in V){const o={...V[t]};if(f.value.push(o),(s=r.value)==null?void 0:s.socialUsers){for(const p in r.value.socialUsers)if(o.type===r.value.socialUsers[p].type){o.openid=r.value.socialUsers[p].openid;break}}}},a=$(),g=()=>{const e=a.query.type,s=a.query.code,t=a.query.state;s&&((o,p,i)=>b.post({url:"/system/social-user/bind",data:{type:o,code:p,state:i}}))(e,s,t).then(()=>{y.success("\u7ED1\u5B9A\u6210\u529F"),c()})},H=e=>{const s=location.origin+"/user/profile?type="+e.type;((t,o)=>b.get({url:"/system/auth/social-auth-redirect?type="+t+"&redirectUri="+o}))(e.type,encodeURIComponent(s)).then(t=>{window.location.href=t})},J=async e=>{var s,t;await(s=e.type,t=e.openid,b.delete({url:"/system/social-user/unbind",data:{type:s,openid:t}}))&&(e.openid=void 0),y.success("\u89E3\u7ED1\u6210\u529F")};return z(async()=>{await c()}),A(()=>a,e=>{g()},{immediate:!0}),(e,s)=>{const t=E,o=C,p=D;return d(),_(p,{data:U(f),"show-header":!1},{default:h(()=>[u(t,{fixed:"left",title:"\u5E8F\u53F7",type:"seq",width:"60"}),u(t,{align:"left",label:"\u793E\u4EA4\u5E73\u53F0",width:"120"},{default:h(({row:i})=>[O("img",{src:i.img,alt:"",class:"h-5 align-middle"},null,8,I),O("p",v,B(i.title),1)]),_:1}),u(t,{align:"center",label:"\u64CD\u4F5C"},{default:h(({row:i})=>[i.openid?(d(),S(R,{key:0},[k(" \u5DF2\u7ED1\u5B9A "),u(o,{class:"mr-5",title:"(\u89E3\u7ED1)",type:"primary",onClick:K=>J(i)},null,8,["onClick"])],64)):(d(),S(R,{key:1},[k(" \u672A\u7ED1\u5B9A "),u(o,{class:"mr-5",title:"(\u7ED1\u5B9A)",type:"primary",onClick:K=>H(i)},null,8,["onClick"])],64))]),_:1})]),_:1},8,["data"])}}})});export{j as _,tt as __tla};
